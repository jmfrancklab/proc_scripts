<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>pyspecProcScripts package &#8212; pyspecProcScripts 0.9 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=832af5b0" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery_custom.css?v=0838f141" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=2b30a6e6" />
    <script src="../_static/documentation_options.js?v=049aceee"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="pyspecprocscripts-package">
<h1>pyspecProcScripts package<a class="headerlink" href="#pyspecprocscripts-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-pyspecProcScripts.CPMG_phasing">
<span id="pyspecprocscripts-cpmg-phasing-module"></span><h2>pyspecProcScripts.CPMG_phasing module<a class="headerlink" href="#module-pyspecProcScripts.CPMG_phasing" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.CPMG_phasing.center_echo">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.CPMG_phasing.</span></span><span class="sig-name descname"><span class="pre">center_echo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">echo_center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.CPMG_phasing.center_echo" title="Link to this definition">¶</a></dt>
<dd><p>Centers data around echo center given, and applies
a zeroth order phase correction.</p>
<p>Will generate an error if the echo appears to be extremely lopsided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>echo_center</strong> (<em>float</em>) – center of echo</p></li>
<li><p><strong>axis</strong> (<em>str</em>) – axis along which the echo is being centered</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.CPMG_phasing.minimize_CPMG_imag">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.CPMG_phasing.</span></span><span class="sig-name descname"><span class="pre">minimize_CPMG_imag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.CPMG_phasing.minimize_CPMG_imag" title="Link to this definition">¶</a></dt>
<dd><p>optimize the first and second order phase of a CPMG pulse sequence
by minimizing the energy of its imaginary component</p>
</dd></dl>

</section>
<section id="module-pyspecProcScripts.DCCT_func">
<span id="pyspecprocscripts-dcct-func-module"></span><h2>pyspecProcScripts.DCCT_func module<a class="headerlink" href="#module-pyspecProcScripts.DCCT_func" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.DCCT_func.DCCT">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.DCCT_func.</span></span><span class="sig-name descname"><span class="pre">DCCT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">this_nddata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">this_fig_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_bottom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bottom_pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.055</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_spacing_multiplier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_for_text_default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_for_ticks_default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">70</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LHS_pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RHS_pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shareaxis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pass_frq_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">just_2D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_coh_jump</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'ph1':</span> <span class="pre">2,</span> <span class="pre">'ph2':</span> <span class="pre">1}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'DCCT'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.DCCT_func.DCCT" title="Link to this definition">¶</a></dt>
<dd><p>DCCT plot</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this_nddata</strong> (<em>psd.nddata</em>) – data being plotted</p></li>
<li><p><strong>thi_fig_obj</strong> (<em>figure</em>) – size/type of figure to be plotted on</p></li>
<li><p><strong>custom_scaling</strong> (<em>boolean</em>) – allows user to scale the intensity of data presented</p></li>
<li><p><strong>grid_bottom</strong> (<em>float</em>) – coordinate for bottom of DCCT plot</p></li>
<li><p><strong>bottom_pad</strong> (<em>float</em>) – distance between bottom of grid and bottom of figure</p></li>
<li><p><strong>grid_top</strong> (<em>float</em>) – coordinate top of grid in figure</p></li>
<li><p><strong>top_pad</strong> (<em>float</em>) – distance between top of figure and top of grid</p></li>
<li><p><strong>total_spacing</strong> (<em>float</em>) – affects spacing between phase cycle dimensions</p></li>
<li><p><strong>label_spacing_multiplier</strong> (<em>int</em>) – spacing between axes labels</p></li>
<li><p><strong>allow_for_text_default</strong> (<em>int</em>) – adjusts distance between tick labels and ticks</p></li>
<li><p><strong>allow_for_ticks_default</strong> (<em>int</em>) – adjusts distance between ticks</p></li>
<li><p><strong>text_height</strong> (<em>int</em>) – adjusts sizing of axis labels and tick labels</p></li>
<li><p><strong>LHS_pad</strong> (<em>float</em>) – adjusts padding on left hand side of DCCT plot</p></li>
<li><p><strong>RHS_pad</strong> (<em>float</em>) – adjusts padding on right hand side of DCCT plot</p></li>
<li><p><strong>shareaxis</strong> (<em>boolean</em>) – subplots scale together, but currently, this means there
must be tick
labels on both top and bottom</p></li>
<li><p><strong>cmap</strong> (<em>str</em>) – string for color mapping if specified</p></li>
<li><p><strong>pass_frq_slice</strong> (<em>boolean</em>) – if true will show the frequency sliced out with hatching</p></li>
<li><p><strong>just_2D</strong> (<em>boolean</em>) – If true will only return axis coordinates/shape NOT ax_list</p></li>
<li><p><strong>scaling_factor</strong> (<em>float</em>) – If using custom scaling this allows user to set the scaling
factor</p></li>
<li><p><strong>max_coh_jump</strong> (<em>dict</em>) – maximum allowed transitions for each phase cycle</p></li>
<li><p><strong>direct</strong> (<em>str</em>) – name of direct axis</p></li>
<li><p><strong>plot_title</strong> (<em>str</em>) – title for DCCT plot</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyspecProcScripts.Utility">
<span id="pyspecprocscripts-utility-module"></span><h2>pyspecProcScripts.Utility module<a class="headerlink" href="#module-pyspecProcScripts.Utility" title="Link to this heading">¶</a></h2>
<p>These are simple utility functions</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.Utility.Vpp2power">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.Utility.</span></span><span class="sig-name descname"><span class="pre">Vpp2power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Vpp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.Utility.Vpp2power" title="Link to this definition">¶</a></dt>
<dd><p>convert peak to peak voltage to power</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.Utility.dBm2power">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.Utility.</span></span><span class="sig-name descname"><span class="pre">dBm2power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dBm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.Utility.dBm2power" title="Link to this definition">¶</a></dt>
<dd><p>convert from dBm to W</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.Utility.power2dBm">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.Utility.</span></span><span class="sig-name descname"><span class="pre">power2dBm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">power</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.Utility.power2dBm" title="Link to this definition">¶</a></dt>
<dd><p>convert from W to dBm</p>
</dd></dl>

</section>
<section id="module-pyspecProcScripts.apod_matched_filter">
<span id="pyspecprocscripts-apod-matched-filter-module"></span><h2>pyspecProcScripts.apod_matched_filter module<a class="headerlink" href="#module-pyspecProcScripts.apod_matched_filter" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.apod_matched_filter.apod_matched_filter">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.apod_matched_filter.</span></span><span class="sig-name descname"><span class="pre">apod_matched_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convolve_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ret_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.apod_matched_filter.apod_matched_filter" title="Link to this definition">¶</a></dt>
<dd><section id="apodization-matched-filter">
<h3>Apodization Matched Filter<a class="headerlink" href="#apodization-matched-filter" title="Link to this heading">¶</a></h3>
<p>This function finds a
Gaussian or Lorentzian lineshape whose
linewidth matches that of the data, then
multiplies the data by this matched-width
lineshape, ultimately returning an
apodized version of the input data .</p>
<dl class="simple">
<dt>axis: str</dt><dd><p>find matched filter along <cite>axisname</cite></p>
</dd>
<dt>convolve_method: str</dt><dd><p>specify as one of the following 2 options:
* Option 1 - ‘gaussian’
finds a matched-filter Gaussian to the
input data
* Option 2 - ‘lorentzian’
finds a matched-filter Lorentzian to the
input data</p>
</dd>
<dt>ret_width: float</dt><dd><p>returns the linewidth found for the matched filter, typically not necessary</p>
</dd>
<dt>fl: None or figlist_var()</dt><dd><p>to show diagnostic plots, set <cite>fl</cite> to the
figure list; set <cite>fl</cite> to None in order not
to see any diagnostic plots</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-pyspecProcScripts.baseline">
<span id="pyspecprocscripts-baseline-module"></span><h2>pyspecProcScripts.baseline module<a class="headerlink" href="#module-pyspecProcScripts.baseline" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.baseline.calc_baseline">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.baseline.</span></span><span class="sig-name descname"><span class="pre">calc_baseline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">this_d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ph1lim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.baseline.calc_baseline" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the baseline for an FID-like spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this_d</strong> (<em>nddata</em>) – complex data that needs baseline</p></li>
<li><p><strong>ph1lim</strong> (<em>range</em><em> of </em><em>ph1 dimension used</em>) – </p></li>
<li><p><strong>npts</strong> (<em>integer for shape</em><em> of </em><em>array</em>) – </p></li>
<li><p><strong>guess</strong> (<em>guessed baseline array</em><em> or </em><em>None</em>) – if None will fill array shape given with
zeroes. If guess then will fill shape given
with guess.</p></li>
<li><p><strong>show_plots</strong> (<em>True</em><em> or </em><em>False</em>) – If the plots are wanted set to True.
This will add a plot called “try
baseline correction” for before and
after the baseline correction</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>phcorr0</strong> (<em>zeroth order phase correction</em>)</p></li>
<li><p><strong>phcorr1</strong> (<em>first order phase correction</em>)</p></li>
<li><p><strong>baseline</strong> (<em>generated baseline in form of array</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyspecProcScripts.clock_correct">
<span id="pyspecprocscripts-clock-correct-module"></span><h2>pyspecProcScripts.clock_correct module<a class="headerlink" href="#module-pyspecProcScripts.clock_correct" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.clock_correct.clock_correct">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.clock_correct.</span></span><span class="sig-name descname"><span class="pre">clock_correct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indirect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vd'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.clock_correct.clock_correct" title="Link to this definition">¶</a></dt>
<dd><p>Do clock correction.</p>
<p>On spincore, the Tx carrier (clock) and Rx carrier do not seem to be
exactly the same.
This can be proven with a simple experiment that involves changing
the time between phase reset and the start of the pulses.
It is subtle, so it only affects things with longer delays, like T₁
measurements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>nddata</em>) – The data to be corrected.</p></li>
<li><p><strong>indirect</strong> (<em>str</em>) – The dimension along which to clock correct.</p></li>
<li><p><strong>fl</strong> (<em>figlist</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>s</strong> – modified in-place</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nddata</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyspecProcScripts.convert_to_power">
<span id="pyspecprocscripts-convert-to-power-module"></span><h2>pyspecProcScripts.convert_to_power module<a class="headerlink" href="#module-pyspecProcScripts.convert_to_power" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.convert_to_power.convert_to_power">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.convert_to_power.</span></span><span class="sig-name descname"><span class="pre">convert_to_power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'log'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directional_coupler_dB</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">22</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.convert_to_power.convert_to_power" title="Link to this definition">¶</a></dt>
<dd><p>Generate power axis for ODNP/E(p)/FIR experiments, converts instrument
power log to useable axis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>nddata</em>) – This is an nddata whose “indirect”
axis is a structured array.  This structured array gives the
<cite>start_times</cite> and <cite>stop_times</cite> (as fields) for each datapoint
along the indirect axis.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – Name of the hdf file that contains the power log.</p></li>
<li><p><strong>exp_type</strong> (<em>str</em>) – The “experiment type” used to search for the file.
directional_coupler_dB : float
The ratio (in dB) of the power that leaves the main port of the
directional coupler vs. the power that arrives at the power
detector.  This is measured, and the value here is a previously
measured value for our system.</p></li>
<li><p><strong>fl</strong> (<em>figlist_var</em><em>(</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>values</strong> (<em>numpy.array</em>)</p></li>
<li><p><strong>s</strong> (<em>nddata</em>) – (modified in-place)
When we’re done, the axis coordinates for “indirect” are a (not
structured) array containing the average power recorded on the
log between each start_time and stop_time.
The axis coordinate errors are the standard deviations of the
same.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyspecProcScripts.correlation_alignment">
<span id="pyspecprocscripts-correlation-alignment-module"></span><h2>pyspecProcScripts.correlation_alignment module<a class="headerlink" href="#module-pyspecProcScripts.correlation_alignment" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.correlation_alignment.correl_align">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.correlation_alignment.</span></span><span class="sig-name descname"><span class="pre">correl_align</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s_orig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_phases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indirect_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'indirect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'correlation</span> <span class="pre">alignment'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_pathway</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'ph1':</span> <span class="pre">0,</span> <span class="pre">'ph2':</span> <span class="pre">1}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.correlation_alignment.correl_align" title="Link to this definition">¶</a></dt>
<dd><p>Align transients collected with chunked phase cycling dimensions along an
indirect dimension based on maximizing the correlation across all the
transients and repeat alignment until the calculated signal energy remains
constant to within a given tolerance level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s_orig</strong> (<em>psd.nddata</em>) – A psd.nddata object which contains phase cycle dimensions and an
indirect dimension.</p></li>
<li><p><strong>align_phases</strong> (<em>boolean</em>) – </p></li>
<li><p><strong>tol</strong> (<em>float</em>) – Sets the tolerance limit for the alignment procedure.</p></li>
<li><p><strong>indirect_dim</strong> (<em>str</em>) – Name of the indirect dimension along which you seek to
align
the transients.</p></li>
<li><p><strong>fig_title</strong> (<em>str</em>) – Title for the figures generated.</p></li>
<li><p><strong>signal_pathway</strong> (<em>dict</em>) – Dictionary containing the signal pathway.</p></li>
<li><p><strong>shift_bounds</strong> (<em>boolean</em>) – Keeps f_shift to be within a specified
limit (upper and lower bounds given by max_shift)
which should be around the location of the expected
signal.</p></li>
<li><p><strong>avg_dim</strong> (<em>str</em>) – Dimension along which the data is being averaged.</p></li>
<li><p><strong>max_shift</strong> (<em>float</em>) – Specifies the upper and lower bounds to the range over
which f_shift will be taken from the correlation function.
Shift_bounds must be True.</p></li>
<li><p><strong>sigma</strong> (<em>int</em>) – Sigma value for the Gaussian mask. Related to the line
width of the given data.</p></li>
<li><p><strong>fl</strong> (<em>boolean</em>) – fl=fl to show the plots and figures produced by this
function otherwise, fl=None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>f_shift</strong> (<em>np.array</em>) – The optimized frequency shifts for each transient which will
maximize their correlation amongst each other, thereby aligning
them.</p></li>
<li><p><strong>sigma</strong> (<em>float</em>) – The width of the Gaussian function used to frequency filter
the data in the calculation of the correlation function.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyspecProcScripts.envelope">
<span id="pyspecprocscripts-envelope-module"></span><h2>pyspecProcScripts.envelope module<a class="headerlink" href="#module-pyspecProcScripts.envelope" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.envelope.L2G">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.envelope.</span></span><span class="sig-name descname"><span class="pre">L2G</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambda_L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'energy'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.envelope.L2G" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.envelope.fit_envelope">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.envelope.</span></span><span class="sig-name descname"><span class="pre">fit_envelope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8.434</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'envelope'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_expanding_envelope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.envelope.fit_envelope" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-pyspecProcScripts.fitting">
<span id="pyspecprocscripts-fitting-module"></span><h2>pyspecProcScripts.fitting module<a class="headerlink" href="#module-pyspecProcScripts.fitting" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.fitting.decay">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.fitting.</span></span><span class="sig-name descname"><span class="pre">decay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indirect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'indirect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.fitting.decay" title="Link to this definition">¶</a></dt>
<dd><p>Take phased data, slice and integrate it in order to fit a T2 decay curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>direct</strong> (<em>str</em>) – name of the direct dimension</p></li>
<li><p><strong>indirect</strong> (<em>str</em>) – name of the indirect dimension, along which the recovery is measured</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>f</strong> (<em>fitdata</em>) – the full fitdata object with all info about the fit curve</p></li>
<li><p><strong>T1</strong> (<em>float</em>) – just the T1 relaxation time</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.fitting.recovery">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.fitting.</span></span><span class="sig-name descname"><span class="pre">recovery</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indirect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'indirect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.fitting.recovery" title="Link to this definition">¶</a></dt>
<dd><p>Take phased data, slice and integrate it in order to fit an inversion recovery curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>direct</strong> (<em>str</em>) – name of the direct dimension</p></li>
<li><p><strong>indirect</strong> (<em>str</em>) – name of the indirect dimension, along which the recovery is measured</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>f</strong> (<em>fitdata</em>) – the full fitdata object with all info about the fit curve</p></li>
<li><p><strong>T1</strong> (<em>float</em>) – just the T1 relaxation time</p></li>
<li><p><strong>save_guess</strong> (<em>nddata</em>) – returned only if the guess argument is set.
Give an nddata with all parameters set to the guess value.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyspecProcScripts.fwhm_calculate">
<span id="pyspecprocscripts-fwhm-calculate-module"></span><h2>pyspecProcScripts.fwhm_calculate module<a class="headerlink" href="#module-pyspecProcScripts.fwhm_calculate" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.fwhm_calculate.fwhm_calculator">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.fwhm_calculate.</span></span><span class="sig-name descname"><span class="pre">fwhm_calculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.fwhm_calculate.fwhm_calculator" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-pyspecProcScripts.generate_integrals">
<span id="pyspecprocscripts-generate-integrals-module"></span><h2>pyspecProcScripts.generate_integrals module<a class="headerlink" href="#module-pyspecProcScripts.generate_integrals" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.generate_integrals.generate_integrals">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.generate_integrals.</span></span><span class="sig-name descname"><span class="pre">generate_integrals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">searchstr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_pathway</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'ph1':</span> <span class="pre">0,</span> <span class="pre">'ph2':</span> <span class="pre">1}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">excluded_pathways</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[(0,</span> <span class="pre">0)]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indirect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'indirect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alias_slop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clock_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_bars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correlate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.generate_integrals.generate_integrals" title="Link to this definition">¶</a></dt>
<dd><p>Applies appropriate phase corrections, along with DC offset corrections,
alignment, and integrates the data to transform 2D datasets into a table
of integrals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>searchstr</strong> (<em>str</em>) – string for the title of the plots produced.</p></li>
<li><p><strong>signal_pathway</strong> (<em>dict</em>) – Dictionary of the path of the desired signal.</p></li>
<li><p><strong>excluded_pathways</strong> (<em>dict</em>) – Dictionary of all coherence pathways that are not
the signal pathway.</p></li>
<li><p><strong>f_range</strong> (<em>tuple</em>) – Frequency range over which the signal resides.</p></li>
<li><p><strong>direct</strong> (<em>str</em>) – Direct dimension of the signal</p></li>
<li><p><strong>indirect</strong> (<em>str</em>) – Indirect dimension of the signal. Usually ‘power’ or
‘nScans’ for example.</p></li>
<li><p><strong>alias_slop</strong> (<em>int</em>) – Aliasing_slop used in the hermitian function.</p></li>
<li><p><strong>clock_correction</strong> (<em>bool</em>) – If true, will apply a clock correction. Is needed for
IR but not enhancement data.</p></li>
<li><p><strong>error_bars</strong> (<em>bool</em>) – Option to apply integration <em>with</em> error bars.</p></li>
<li><p><strong>correlate</strong> (<em>bool</em>) – Option to apply correlation alignment to data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>s</strong> (<em>psd.nddata</em>) – Data with applied corrections but <em>not</em> integrated</p></li>
<li><p><strong>s_int</strong> (<em>psd.nddata</em>) – Integrated and corrected data</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyspecProcScripts.integral_w_error">
<span id="pyspecprocscripts-integral-w-error-module"></span><h2>pyspecProcScripts.integral_w_error module<a class="headerlink" href="#module-pyspecProcScripts.integral_w_error" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.integral_w_error.active_propagation">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.integral_w_error.</span></span><span class="sig-name descname"><span class="pre">active_propagation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indirect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.integral_w_error.active_propagation" title="Link to this definition">¶</a></dt>
<dd><p>propagate error from the region <cite>offset</cite> to the right of the peak (where
we assume there is only noise),  in the signal pathway <cite>signal_path</cite>, which
we assume is the active coherence pathway.
Include only the real part of the signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal_path</strong> (<em>dict</em>) – Dictionary givin the active CT pathway</p></li>
<li><p><strong>indirect</strong> (<em>str</em>) – Name of the indirect dimension – used to check that you don’t have
directions that are not direct, indirect, or phase cycling.</p></li>
<li><p><strong>direct</strong> (<em>str</em>) – Name of the direct dimension</p></li>
<li><p><strong>offset</strong> (<em>float</em>) – Distance (in Hz) between the auto-chosen integration bounds from
<code class="xref py py-func docutils literal notranslate"><span class="pre">integrate_limits()</span></code> and the start of the “noise region.”</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>retval</strong> – just a data object with the error that this method predicts</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nddata</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.integral_w_error.integral_w_errors">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.integral_w_error.</span></span><span class="sig-name descname"><span class="pre">integral_w_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convolve_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indirect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_frq_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.integral_w_error.integral_w_errors" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the propagation of error for the given signal and returns
signal with the error associated.</p>
<p>Before declaring the error_path,
look at an examples such as integration_w_error.py to see how to
decide which excluded pathways to take the error over.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sig_path</strong> (<em>dict</em>) – Dictionary of the path of the desired signal.</p></li>
<li><p><strong>error_path</strong> (<em>dict</em>) – <p>Dictionary of all coherence pathways that are
not the signal pathway.</p>
<p>Before declaring the error_path,
look at an examples such as integration_w_error.py to
see how to decide which excluded pathways to take the
error over.</p>
</p></li>
<li><p><strong>convolve_method</strong> (<em>str</em>) – method of convolution used in integrating limits
passed on to <code class="xref py py-func docutils literal notranslate"><span class="pre">integrate_limits()</span></code></p></li>
<li><p><strong>indirect</strong> (<em>str</em>) – Indirect axis.</p></li>
<li><p><strong>direct</strong> (<em>str</em>) – Direct axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>s</strong> – Data with error associated with coherence pathways
not included in the signal pathway.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nddata</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyspecProcScripts.integrate_limits">
<span id="pyspecprocscripts-integrate-limits-module"></span><h2>pyspecProcScripts.integrate_limits module<a class="headerlink" href="#module-pyspecProcScripts.integrate_limits" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.integrate_limits.integrate_limits">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.integrate_limits.</span></span><span class="sig-name descname"><span class="pre">integrate_limits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convolve_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.integrate_limits.integrate_limits" title="Link to this definition">¶</a></dt>
<dd><p>This function takes data in the frequency
domain and finds the corresponding frequency
limits of the signal for integration.</p>
<p>Limits are found by applying a matched filter
(choice of Lorentzian or Gaussian <code class="docutils literal notranslate"><span class="pre">convolve_method</span></code>) to the
frequency domain data, which it then uses to
determine the integration limits based on a
<code class="docutils literal notranslate"><span class="pre">cutoff</span></code> amplitude based as a fraction of the maximum signal intensity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>str</em>) – apply convolution along <cite>axisname</cite></p></li>
<li><p><strong>convolve_method</strong> (<em>str</em>) – specify as one of the following 3 options:
* Option 1 - ‘gaussian’
to calculate the matched-filter via
Gaussian convolution of the frequency
domain signal.
* Option 2 - ‘lorentzian’
to calculate the matched-filter via
Lorentzian convolution of the frequency
domain signal.</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>) – set the integration limit to the points where the convolved signal
crosses this fraction of its maximum.
(e.g. cutoff=0.5 would give integration limits that correspond to the
frequencies marking the full width half maximum of the convolution of
the signal and its matched filter)</p></li>
<li><p><strong>fl</strong> (<em>None</em><em> or </em><em>figlist_var</em><em>(</em><em>)</em>) – to show diagnostic plots, set <cite>fl</cite> to the figure list; set <cite>fl</cite> to None in
order not to see any diagnostic plots</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyspecProcScripts.load_data">
<span id="pyspecprocscripts-load-data-module"></span><h2>pyspecProcScripts.load_data module<a class="headerlink" href="#module-pyspecProcScripts.load_data" title="Link to this heading">¶</a></h2>
<section id="postproc-dict-and-functions">
<h3>Postproc dict and functions<a class="headerlink" href="#postproc-dict-and-functions" title="Link to this heading">¶</a></h3>
<p>Used to preprocess data based on type of experiment performed.
Returns all data FTed into the frequency domain with the phase
cycles also FTed (coherence domain).
Data is not sliced or manipulated in any other way that would reduce
information content.</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.hack_field_sweep_v4">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">hack_field_sweep_v4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.hack_field_sweep_v4" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.hack_spincore_IR_v3">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">hack_spincore_IR_v3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.hack_spincore_IR_v3" title="Link to this definition">¶</a></dt>
<dd><p>v3 has an incorrectly stored coherence pathway</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_DOSY_CPMG">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_DOSY_CPMG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_DOSY_CPMG" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_ESR">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_ESR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_ESR" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_FID_v1">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_FID_v1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_FID_v1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_Hahn_echoph">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_Hahn_echoph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_Hahn_echoph" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_bruker_CPMG_v1">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_bruker_CPMG_v1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_bruker_CPMG_v1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_bruker_T1CPMG_v1">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_bruker_T1CPMG_v1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_bruker_T1CPMG_v1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_bruker_deut_IR_mancyc">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_bruker_deut_IR_mancyc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_bruker_deut_IR_mancyc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_bruker_deut_IR_withecho_mancyc">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_bruker_deut_IR_withecho_mancyc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_bruker_deut_IR_withecho_mancyc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_capture">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_capture</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_capture" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_field_sweep_v1">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_field_sweep_v1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_field_sweep_v1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_field_sweep_v2">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_field_sweep_v2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_field_sweep_v2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_nutation">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_nutation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_nutation" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_nutation_amp">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_nutation_amp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_nutation_amp" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_nutation_chunked">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_nutation_chunked</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_nutation_chunked" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_nutation_v2">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_nutation_v2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_nutation_v2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_nutation_v4">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_nutation_v4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_nutation_v4" title="Link to this definition">¶</a></dt>
<dd><p>nutation curve</p>
<p>note that v4 are assumed to have an indirect axis labeled in SI units.
Note that data acquired on 6/25 or before might have really messed up axis
coordinates (some are multiplied by 1e12!)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_spincore_CPMG_v1">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_spincore_CPMG_v1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_spincore_CPMG_v1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_spincore_IR">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_spincore_IR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_spincore_IR" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_spincore_IR_v2">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_spincore_IR_v2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_spincore_IR_v2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_spincore_ODNP_v1">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_spincore_ODNP_v1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_spincore_ODNP_v1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_spincore_ODNP_v2">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_spincore_ODNP_v2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_spincore_ODNP_v2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_spincore_ODNP_v3">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_spincore_ODNP_v3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_spincore_ODNP_v3" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_spincore_ODNP_v4">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_spincore_ODNP_v4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_spincore_ODNP_v4" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_spincore_SE_v1">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_spincore_SE_v1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_spincore_SE_v1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_spincore_diffph_SE_v1">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_spincore_diffph_SE_v1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_spincore_diffph_SE_v1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_spincore_diffph_SE_v2">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_spincore_diffph_SE_v2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_spincore_diffph_SE_v2" title="Link to this definition">¶</a></dt>
<dd><p>this one uses a phase cycle where the overall phase and 90-180
phase difference are cycled in a nested way – see the DCCT paper to
understand this!</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_spincore_echo_v1">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_spincore_echo_v1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_spincore_echo_v1" title="Link to this definition">¶</a></dt>
<dd><p>old-fashioned (not properly shaped before storage) echo data</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_spincore_generalproc_v1">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_spincore_generalproc_v1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_tau_sub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_spincore_generalproc_v1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.load_data.proc_var_tau">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.load_data.</span></span><span class="sig-name descname"><span class="pre">proc_var_tau</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.load_data.proc_var_tau" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-pyspecProcScripts.phasing">
<span id="pyspecprocscripts-phasing-module"></span><h2>pyspecProcScripts.phasing module<a class="headerlink" href="#module-pyspecProcScripts.phasing" title="Link to this heading">¶</a></h2>
<p>This module includes routines for phasing NMR spectra.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.phasing.det_devisor">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.phasing.</span></span><span class="sig-name descname"><span class="pre">det_devisor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fl</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.phasing.det_devisor" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.phasing.determine_sign">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.phasing.</span></span><span class="sig-name descname"><span class="pre">determine_sign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_freq_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_pathway</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.phasing.determine_sign" title="Link to this definition">¶</a></dt>
<dd><p>Determines the sign of the signal based on the difference between the
signal with the zeroth order phase correction applied to the entire data
set vs applying the zeroth order phase correction to each individual
indirect index.  The sign can be used, so that when multiplied by the
signal the data has a uniform
sign along the indirect axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>nddata</em>) – Data with a single (dominant) peak, where you want to return the sign
of the integral over all the data.</p></li>
<li><p><strong>signal_freq_range</strong> (<em>tuple</em>) – Narrow slice range where signal resides.</p></li>
<li><p><strong>direct</strong> (<em>str</em><em> (</em><em>default &quot;t2&quot;</em><em>)</em>) – Name of the direct dimension.</p></li>
<li><p><strong>signal_pathway</strong> (<em>dict</em><em> (</em><em>default None</em><em>)</em>) – If None, the function will go into the properties of the data looking
for the “coherence_pathway” property. If that doesn’t exist the user
needs to feed a dictionary containing the coherence transfer pathway
where the signal resides.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>mysign</strong> – A dataset with all +1 or -1 (giving the sign of the original signal).
Does <em>not</em> include the <cite>direct</cite> dimension.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nddata</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.phasing.fid_from_echo">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.phasing.</span></span><span class="sig-name descname"><span class="pre">fid_from_echo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_pathway</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_rising</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_rising</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_multiplier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_lower_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_hermitian_sign_flipped</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_shifted_residuals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frq_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frq_half</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.phasing.fid_from_echo" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal_pathway</strong> (<em>dict</em>) – coherence transfer pathway that correspond to the signal</p></li>
<li><p><strong>fl</strong> (<em>figlist</em><em> or </em><em>None</em><em> (</em><em>default</em><em>)</em>) – If you want the diagnostic plots (showing the distribution of the
data in the complex plane), set this to your figlist object.</p></li>
<li><p><strong>add_rising</strong> (<em>boolean</em>) – Take the first part of the echo (that which rises to the maximum)
and add the decaying (FID like) part. This increases the SNR of
the early points of the signal.</p></li>
<li><p><strong>direct</strong> (<em>string</em>) – Name of the direct dimension</p></li>
<li><p><strong>exclude_rising</strong> (<em>int</em>) – In general it is assumed that the first few points of signal
might be messed up due to dead time or other issues (assuming a
tau of 0).  This option allows us to add a rising edge to the
echo and exclude the first few points of the signal. Note, to use
this, add_rising must be True.</p></li>
<li><p><strong>slice_multiplier</strong> (<em>int</em>) – The calculated frequency slice is calculated by taking the center
frequency and extending out to values that are included in the
peak times this multiplier. Therefore the larger this value the
larger the frequency slice. Increasing this value might serve
useful in the case of noisy spectra.</p></li>
<li><p><strong>peak_lower_thresh</strong> (<em>float</em>) – Fraction of the signal intensity used in calculating the
frequency slice. The smaller the value, the wider the slice.</p></li>
<li><p><strong>show_hermitian_sign_flipped</strong> (<em>boolean</em>) – Diagnostic in checking the sign of the signal prior to the
hermitian phase correction</p></li>
<li><p><strong>show_shifted_residuals</strong> (<em>boolean</em>) – Diagnostic in analyzing the residuals after the hermitian phase
correction.</p></li>
<li><p><strong>frq_center</strong> (<em>float</em><em> (</em><em>default None</em><em>)</em>) – The center of the peak.
This only exists so that we don’t end up calling
<cite>find_peakrange</cite> redundantly,
and it should come from a previous call to <cite>find_peakrange</cite> if
it’s used.</p></li>
<li><p><strong>frq_half</strong> (<em>float</em><em> (</em><em>default None</em><em>)</em>) – The half-width of the peak.
This only exists so that we don’t end up calling
<cite>find_peakrange</cite> redundantly,
and it should come from a previous call to <cite>find_peakrange</cite> if
it’s used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>d</strong> – FID of properly sliced and phased signal</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nddata</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.phasing.find_peakrange">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.phasing.</span></span><span class="sig-name descname"><span class="pre">find_peakrange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_lower_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.phasing.find_peakrange" title="Link to this definition">¶</a></dt>
<dd><p>find the range of frequencies over which the signal occurs, so that we
can autoslice</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>nddata</em>) – Data in the frequency domain – will not be altered.</p></li>
<li><p><strong>direct</strong> (<em>str</em><em> (</em><em>default &quot;t2&quot;</em><em>)</em>) – The name of the direct dimension</p></li>
<li><p><strong>peak_lower_thresh</strong> (<em>float</em>) – Fraction of the signal intensity used in calculating the
frequency slice. The smaller the value, the wider the slice.</p></li>
<li><p><strong>fl</strong> (<em>figlist</em><em> (</em><em>default None</em><em>)</em>) – If you want to see diagnostic plots, feed the figure list.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>frq_center</strong> (<em>float</em>) – The midpoint of the frequency slice.</p></li>
<li><p><strong>frq_half</strong> (<em>float</em>) – Half the width of the frequency slice.
Given in this way, so you can easily do
&gt;&gt;&gt; newslice = r_[-expansino,expansion]*frq_half+frq_center</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.phasing.hermitian_function_test">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.phasing.</span></span><span class="sig-name descname"><span class="pre">hermitian_function_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aliasing_slop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_extended</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.98</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_threshold_lower</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_refinement</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.phasing.hermitian_function_test" title="Link to this definition">¶</a></dt>
<dd><p>Determine the center of the echo via hermitian symmetry of the time
domain.</p>
<p>Note the following issues/feature:</p>
<ul class="simple">
<li><p>Data <em>must</em> start at t=0 (due to the way that we calculate the energy
term in the expression)</p></li>
<li><p>Data typically has a rising edge, which can lead to ringing.
Therefore, we apply a Tukey filter to the data.  Because this
suppresses the edges in frequency space, you will likely want to slice
a slightly wider bandwidth than you are interested in.</p></li>
<li><p>If you have an initial portion of signal that has very low SNR (i.e. if
your echo time is long relative to <span class="math notranslate nohighlight">\(T_2^*\)</span>), that will affect the
SNR of the cost function.  Trailing noise will not affect the SNR of
the cost function, only lead to slightly longer calculation times.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>direct</strong> (<em>str</em>) – Axis of data (i.e., direct dimension).</p></li>
<li><p><strong>energy_threshold</strong> (<em>float</em>) – To avoid picking a minimum that’s based off of very little data, only
recognize the cost function over an interval where the normalized
energy function is equal to <cite>energy_threshold</cite> of its max value.</p></li>
<li><p><strong>aliasing_slop</strong> (<em>int</em><em> (</em><em>default 3</em><em>)</em>) – The signal typically has an initial rising
portion where – even due to FIR or
instrumental filters in the raw data,
the signal has some kind of Gibbs ringing in the
transition between signal an zero.
This portion of the signal will not mirror the
signal on the other side of the echo, and
should not even be included in the cost
function!
We believe the most consistent way to specify
the amount of signal that should be excluded as
an number of datapoints, hence why we ask for
an integer here.</p></li>
<li><p><strong>enable_refinement</strong> (<em>boolean</em>) – Do not use – an attempt to correct for cases where we don’t get
the lowest residual out of the Fourier technique.
The idea was that this was based on the fact that the correlation
function is calculated between the two upsampled (sinc
interpolated) functions, and so we should explicitly calculate
the residual in the original resolution.
But, there appears to be an error that would need to be debugged
– fails some of the basic tests, and the residual does not
always appear to be the lowest.</p></li>
<li><p><strong>todo::</strong> (<em>..</em>) – AG fix docstring + cite coherence paper</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.phasing.ph1_real_Abs">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.phasing.</span></span><span class="sig-name descname"><span class="pre">ph1_real_Abs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ph1_sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ph2_sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.phasing.ph1_real_Abs" title="Link to this definition">¶</a></dt>
<dd><p>Performs first order phase correction with cost function
by taking the sum of the absolute value of the real [DeBrouwer2009].</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>update with <a class="reference external" href="https://sphinxcontrib-bibtex.readthedocs.io/en/latest/usage.html">sphinxcontrib-bibtex</a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>s</strong> (<em>nddata</em>) – Complex data whose first order phase you want
to find.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>retval</em></p></li>
<li><p><strong>.. rubric</strong> (<em>References</em>)</p></li>
<li><p><em>..  [DeBrouwer2009] de Brouwer, H. (2009). Evaluation of algorithms for</em> – automated phase correction of NMR spectra. Journal of Magnetic
Resonance (San Diego, Calif. : 1997), 201(2), 230–238.
<a class="reference external" href="https://doi.org/10.1016/j.jmr.2009.09.017">https://doi.org/10.1016/j.jmr.2009.09.017</a></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.phasing.zeroth_order_ph">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.phasing.</span></span><span class="sig-name descname"><span class="pre">zeroth_order_ph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.phasing.zeroth_order_ph" title="Link to this definition">¶</a></dt>
<dd><p>determine the moment of inertial of the datapoints
in complex plane, and use to phase the
zeroth-order even if the data is both negative
and positive.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>nddata</em>) – Complex data whose zeroth order phase you want
to find.</p></li>
<li><p><strong>fl</strong> (<em>figlist</em><em> or </em><em>None</em><em> (</em><em>default</em><em>)</em>) – If you want the diagnostic plots (showing the
distribution of the data in the complex plane),
set this to your figlist object.
It will add a plot called “check covariance
test”</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>retval</strong> – The zeroth order phase of the data, as a
complex number with magnitude 1.
To correct the zeroth order phase of the data,
divide by <code class="docutils literal notranslate"><span class="pre">retval</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>complex128</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyspecProcScripts.plotting">
<span id="pyspecprocscripts-plotting-module"></span><h2>pyspecProcScripts.plotting module<a class="headerlink" href="#module-pyspecProcScripts.plotting" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.plotting.draw_limits">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.plotting.</span></span><span class="sig-name descname"><span class="pre">draw_limits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thisrange</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.plotting.draw_limits" title="Link to this definition">¶</a></dt>
<dd><p>determines the range of the t2 axis and pairs it with the range given
returns the x axis limits for plotting</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thisrange</strong> (<em>tuple</em><em> of </em><em>2 floats</em>) – slice range you are interested in extending</p></li>
<li><p><strong>s</strong> (<em>nddata</em>) – the data you are planning on slicing</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>the limits for the t2 axis for plotting purposes</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.plotting.expand_limits">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.plotting.</span></span><span class="sig-name descname"><span class="pre">expand_limits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thisrange</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.plotting.expand_limits" title="Link to this definition">¶</a></dt>
<dd><p>“ Used to expand limits of a range (typically used for slicing) by 3X</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thisrange</strong> (<em>tuple</em><em> of </em><em>2 floats</em>) – slice range you are interested in extending</p></li>
<li><p><strong>s</strong> (<em>nddata</em>) – the data you are planning on slicing</p></li>
<li><p><strong>axis</strong> (<em>str</em>) – name of the axis along which the slice range will be applied</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>retval</strong> – the expanded range</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of 2 floats</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyspecProcScripts.plotting.fl_mod">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.plotting.</span></span><span class="sig-name descname"><span class="pre">fl_mod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.plotting.fl_mod" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">figlist</span></code></p>
<p>Extends figlist_var with various new convenience functions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyspecProcScripts.plotting.fl_mod.complex_plot">
<span class="sig-name descname"><span class="pre">complex_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_real</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.plotting.fl_mod.complex_plot" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyspecProcScripts.plotting.fl_mod.next">
<span class="sig-name descname"><span class="pre">next</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.plotting.fl_mod.next" title="Link to this definition">¶</a></dt>
<dd><p>Switch to the figure given by input_name, which is used not only as
a string-based name for the figure, but also as a default title and as
a base name for resulting figure files.</p>
<p><strong>In the future, we actually want this to track the appropriate axis
object!</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>legend</strong> (<em>bool</em>) – If this is set, a legend is created <em>outside</em> the figure.</p></li>
<li><p><strong>twinx</strong> (<em>{0</em><em>,</em><em>1}</em>) – <dl class="field-list simple">
<dt class="field-odd">1<span class="colon">:</span></dt>
<dd class="field-odd"><p>plots on an overlayed axis (the matplotlib twinx) whose y axis
is labeled on the right when you set this for the first time,
you can also set a <cite>color</cite> kwarg that controls the coloring of
the right axis.</p>
</dd>
<dt class="field-even">0<span class="colon">:</span></dt>
<dd class="field-even"><p>used to switch back to the left (default) axis</p>
</dd>
</dl>
</p></li>
<li><p><strong>boundaries</strong> – <strong>need to add description</strong></p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – Any other keyword arguments are passed to the matplotlib (mayavi)
figure() function that’s used to switch (create) figures.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyspecProcScripts.plotting.fl_mod.plot_curve">
<span class="sig-name descname"><span class="pre">plot_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.plotting.fl_mod.plot_curve" title="Link to this definition">¶</a></dt>
<dd><p>Plot the data with fit curve and fit equation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>fitdata</em>) – data (a fitting instance), on which <cite>f.fit()</cite> has already been run</p></li>
<li><p><strong>guess</strong> (<em>None</em><em> or </em><em>nddata</em>) – The result of <cite>s.settoguess();s.eval(100)</cite> where 100 can be
any integer.
Used to display the guess on the plot as well.</p></li>
<li><p><strong>name</strong> (<em>str</em>) – the name of the plot</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyspecProcScripts.plotting.fl_mod.real_imag">
<span class="sig-name descname"><span class="pre">real_imag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plotname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.plotting.fl_mod.real_imag" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyspecProcScripts.plotting.fl_mod.side_by_side">
<span class="sig-name descname"><span class="pre">side_by_side</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plotname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thisrange</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.plotting.fl_mod.side_by_side" title="Link to this definition">¶</a></dt>
<dd><p>a bit of a hack to get the two subplots into
the figure list – also a good test for objective
figure list – for each slice out 3x thisrange, and then
show the lines for thisrange</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyspecProcScripts.simple_functions">
<span id="pyspecprocscripts-simple-functions-module"></span><h2>pyspecProcScripts.simple_functions module<a class="headerlink" href="#module-pyspecProcScripts.simple_functions" title="Link to this heading">¶</a></h2>
<p>First order functions for very simple (a few lines) data manipulation</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.simple_functions.find_apparent_anal_freq">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.simple_functions.</span></span><span class="sig-name descname"><span class="pre">find_apparent_anal_freq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.simple_functions.find_apparent_anal_freq" title="Link to this definition">¶</a></dt>
<dd><p>A function to identify the position of analytic signal as acquired on the oscilloscope.
Importantly this function takes into account the effects of aliasing in identifying the
frequency of the resulting signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>s</strong> (<em>nddata</em>) – data with a single (dominant) peak, where you want to identify the frequency.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>s</strong> (<em>nddata</em>) – The original data that was initially fed to the function</p></li>
<li><p><strong>nu_a</strong> (<em>float</em>) – The apparent frequency of the signal</p></li>
<li><p><strong>isflipped</strong> (<em>boolean</em>) – If aliased from a negative frequency, this notes whether the phase
of the final time domain signal will be flipped</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyspecProcScripts.simple_functions.logobj">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.simple_functions.</span></span><span class="sig-name descname"><span class="pre">logobj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.simple_functions.logobj" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyspecProcScripts.simple_functions.logobj.from_group">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h5group</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.simple_functions.logobj.from_group" title="Link to this definition">¶</a></dt>
<dd><p>initialize a new log object with data loaded from the h5py group
h5group (factory method</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyspecProcScripts.simple_functions.logobj.total_log">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_log</span></span><a class="headerlink" href="#pyspecProcScripts.simple_functions.logobj.total_log" title="Link to this definition">¶</a></dt>
<dd><p>the log is stored internally as a list of arrays – here return a single array for the whole log</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.simple_functions.select_pathway">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.simple_functions.</span></span><span class="sig-name descname"><span class="pre">select_pathway</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.simple_functions.select_pathway" title="Link to this definition">¶</a></dt>
<dd><p>select a particular CT pathway from the signal <cite>s</cite></p>
<p>Arguments are <em>either</em> <code class="docutils literal notranslate"><span class="pre">pathway</span></code> – a dict of key/value pairs indicating
the pathway <strong>or</strong> the same set of key/value pairs, just passed as a dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>nddata</em>) – the data whose coherence pathway you would like to select</p></li>
<li><p><strong>pathway</strong> (<em>dict</em>) – keys are the names of the coherence transfer dimensions (conj. of phase
cycling dimensions) and values are the pathway you want to select</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyspecProcScripts.slice_FID_from_echo">
<span id="pyspecprocscripts-slice-fid-from-echo-module"></span><h2>pyspecProcScripts.slice_FID_from_echo module<a class="headerlink" href="#module-pyspecProcScripts.slice_FID_from_echo" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.slice_FID_from_echo.slice_FID_from_echo">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.slice_FID_from_echo.</span></span><span class="sig-name descname"><span class="pre">slice_FID_from_echo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_pathway</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'ph1':</span> <span class="pre">1,</span> <span class="pre">'ph2':</span> <span class="pre">-2}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.slice_FID_from_echo.slice_FID_from_echo" title="Link to this definition">¶</a></dt>
<dd><p>Automatically slices the FID out of an echo.</p>
<p>Determines the proper position for <span class="math notranslate nohighlight">\(t=0\)</span> from hermitian function test.
This is followed by zeroth order phase correcting and slicing from the center of
the echo (<span class="math notranslate nohighlight">\(t=0\)</span> onward to the t_range defined</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_t</strong> (<em>int</em>) – where the slice ends in the time domain.</p></li>
<li><p><strong>ph1</strong> (<em>int</em>) – the selection of ph1 in the coherence pathway</p></li>
<li><p><strong>ph2</strong> (<em>int</em>) – selection of ph2 in coherence pathway</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>s</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>phase corrected and sliced data</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyspecProcScripts.version">
<span id="pyspecprocscripts-version-module"></span><h2>pyspecProcScripts.version module<a class="headerlink" href="#module-pyspecProcScripts.version" title="Link to this heading">¶</a></h2>
</section>
<section id="module-pyspecProcScripts">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyspecProcScripts" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.DCCT">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">DCCT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">this_nddata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">this_fig_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_bottom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bottom_pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.055</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_spacing_multiplier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_for_text_default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_for_ticks_default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">70</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LHS_pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RHS_pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shareaxis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pass_frq_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">just_2D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_coh_jump</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'ph1':</span> <span class="pre">2,</span> <span class="pre">'ph2':</span> <span class="pre">1}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'DCCT'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.DCCT" title="Link to this definition">¶</a></dt>
<dd><p>DCCT plot</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this_nddata</strong> (<em>psd.nddata</em>) – data being plotted</p></li>
<li><p><strong>thi_fig_obj</strong> (<em>figure</em>) – size/type of figure to be plotted on</p></li>
<li><p><strong>custom_scaling</strong> (<em>boolean</em>) – allows user to scale the intensity of data presented</p></li>
<li><p><strong>grid_bottom</strong> (<em>float</em>) – coordinate for bottom of DCCT plot</p></li>
<li><p><strong>bottom_pad</strong> (<em>float</em>) – distance between bottom of grid and bottom of figure</p></li>
<li><p><strong>grid_top</strong> (<em>float</em>) – coordinate top of grid in figure</p></li>
<li><p><strong>top_pad</strong> (<em>float</em>) – distance between top of figure and top of grid</p></li>
<li><p><strong>total_spacing</strong> (<em>float</em>) – affects spacing between phase cycle dimensions</p></li>
<li><p><strong>label_spacing_multiplier</strong> (<em>int</em>) – spacing between axes labels</p></li>
<li><p><strong>allow_for_text_default</strong> (<em>int</em>) – adjusts distance between tick labels and ticks</p></li>
<li><p><strong>allow_for_ticks_default</strong> (<em>int</em>) – adjusts distance between ticks</p></li>
<li><p><strong>text_height</strong> (<em>int</em>) – adjusts sizing of axis labels and tick labels</p></li>
<li><p><strong>LHS_pad</strong> (<em>float</em>) – adjusts padding on left hand side of DCCT plot</p></li>
<li><p><strong>RHS_pad</strong> (<em>float</em>) – adjusts padding on right hand side of DCCT plot</p></li>
<li><p><strong>shareaxis</strong> (<em>boolean</em>) – subplots scale together, but currently, this means there
must be tick
labels on both top and bottom</p></li>
<li><p><strong>cmap</strong> (<em>str</em>) – string for color mapping if specified</p></li>
<li><p><strong>pass_frq_slice</strong> (<em>boolean</em>) – if true will show the frequency sliced out with hatching</p></li>
<li><p><strong>just_2D</strong> (<em>boolean</em>) – If true will only return axis coordinates/shape NOT ax_list</p></li>
<li><p><strong>scaling_factor</strong> (<em>float</em>) – If using custom scaling this allows user to set the scaling
factor</p></li>
<li><p><strong>max_coh_jump</strong> (<em>dict</em>) – maximum allowed transitions for each phase cycle</p></li>
<li><p><strong>direct</strong> (<em>str</em>) – name of direct axis</p></li>
<li><p><strong>plot_title</strong> (<em>str</em>) – title for DCCT plot</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.L2G">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">L2G</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambda_L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'energy'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.L2G" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.QESR">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">QESR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pushout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pickle_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calibration_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diameter_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_derivative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.QESR" title="Link to this definition">¶</a></dt>
<dd><p>Converts a raw ESR spectra to the double integral and calculates the
appropriate concentration of spins present.</p>
<p>If a background spectra is provided, background subtraction is applied to
the loaded ESR spectra. The double integral is finally rescaled and
multiplied by a proportionality constant associated with the matching value
in your pyspecdata config file.  The resulting plot shows the double
integral with the calculated concentration in micromolar in the legend.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pushout</strong> (<em>float</em>) – Adjusts the “generous limits” factor which is added
to the integration area surrounding the peaks</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – Used in defining the integration limits (threshold*max)</p></li>
<li><p><strong>pickle_file</strong> (<em>str</em>) – Name of pickle file you want to append the concentration to.
(Concentration is stored in μM)</p></li>
<li><p><strong>background</strong> (<em>nddata</em>) – The background spectrum that should already be loaded</p></li>
<li><p><strong>exp_type</strong> (<em>str</em>) – Where the file of interest is</p></li>
<li><p><strong>calibration_name</strong> (<em>str</em>) – Name of the value in your pyspecdata config file that points to
the proportionality constant</p></li>
<li><p><strong>diameter_name</strong> (<em>str</em>) – Name of the value in your pyspecdata config file that points to
the diameter of the capillary being used</p></li>
<li><p><strong>color</strong> (<em>str</em>) – String of the desired color for the plot. This is especially
useful when trying to coordinate color matching with other
plots</p></li>
<li><p><strong>plot_derivative</strong> (<em>boolean</em><em> (</em><em>default False</em><em>)</em>) – If you want to see the (rescaled, background subtracted) spectrum.</p></li>
<li><p><strong>fl</strong> (<em>figure list</em>) – required!</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.QESR_scalefactor">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">QESR_scalefactor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calibration_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diameter_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.QESR_scalefactor" title="Link to this definition">¶</a></dt>
<dd><p>Divide the ESR spectrum by this number so that the double integral
should be equal to concentration in μM.</p>
<p>We specifically calculate
<span class="math notranslate nohighlight">\(d^{2} G_{R}  C_{t}  \sqrt{P}  B_{m}  Q  n_{B}  S  (S + 1) /
c_{propfactor}\)</span>
(the denominator of equation 2-17 in the E500
manual with <span class="math notranslate nohighlight">\(d^2\)</span> (diameter squared) added in,
so that after dividing by this term,
we get a concentration of spins
rather than the total number of spins).</p>
<p>The constant <span class="math notranslate nohighlight">\(c_{propfactor}\)</span> is determined by the calibration name.
Note that a larger <span class="math notranslate nohighlight">\(c_{propfactor}\)</span> corresponds to a higher
concentration
for the same recorded spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>calibration_name</strong> (<em>str</em>) – The key corresponding to the appropriate
proportionality constant
in your pyspecdata config file.
Typically this is one value that doesn’t need changing</p></li>
<li><p><strong>diameter_name</strong> (<em>str</em>) – The key corresponding to the diameter of the
capillary tube used in the ESR experiment. This
enables us to calculate a reliable concentration
regardless of which capillary was used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Denominator of equation 2-17 divided by the proportionality constant.</em></p></li>
<li><p><em>Also includes a factor of 1e-6 to convert Molar to micromolar.</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.Vpp2power">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">Vpp2power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Vpp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.Vpp2power" title="Link to this definition">¶</a></dt>
<dd><p>convert peak to peak voltage to power</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.active_propagation">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">active_propagation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indirect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.active_propagation" title="Link to this definition">¶</a></dt>
<dd><p>propagate error from the region <cite>offset</cite> to the right of the peak (where
we assume there is only noise),  in the signal pathway <cite>signal_path</cite>, which
we assume is the active coherence pathway.
Include only the real part of the signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal_path</strong> (<em>dict</em>) – Dictionary givin the active CT pathway</p></li>
<li><p><strong>indirect</strong> (<em>str</em>) – Name of the indirect dimension – used to check that you don’t have
directions that are not direct, indirect, or phase cycling.</p></li>
<li><p><strong>direct</strong> (<em>str</em>) – Name of the direct dimension</p></li>
<li><p><strong>offset</strong> (<em>float</em>) – Distance (in Hz) between the auto-chosen integration bounds from
<a class="reference internal" href="#pyspecProcScripts.integrate_limits" title="pyspecProcScripts.integrate_limits"><code class="xref py py-func docutils literal notranslate"><span class="pre">integrate_limits()</span></code></a> and the start of the “noise region.”</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>retval</strong> – just a data object with the error that this method predicts</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nddata</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.align_esr">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">align_esr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correlation_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_crossing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.align_esr" title="Link to this definition">¶</a></dt>
<dd><p>open and correlation align ESR spectra.
Store the shifts and scalefactors as
properties of the nddata, which are returned
as a dictionary of nddata.</p>
<section id="details">
<h3>Details<a class="headerlink" href="#details" title="Link to this heading">¶</a></h3>
<p>While we can align by microwave frequency and normalize
according to peak-to-peak amplitude, it scan still be
hard to identify subtle differences between ESR
spectra, and small imperfections – such as free MTSL
– can play an outsized role.</p>
<p>Therefore, here, we use correlation to align the
spectra and then use “dot-product scaling” to normalize
them.  By “dot-product scaling” we mean scaling the
amplitude of one vector (here a spectrum,
<span class="math notranslate nohighlight">\(\mathbf{b}\)</span>) relative to a reference (here
<span class="math notranslate nohighlight">\(\mathbf{a}\)</span>) to minimize the residual between the
two – <em>i.e.</em> we minimize the expression</p>
<div class="math notranslate nohighlight">
\[|\mathbf{a}-c\mathbf{b}|^2\]</div>
<p>by varying the
scaling constant <span class="math notranslate nohighlight">\(c\)</span>.
The solution to this is</p>
<div class="math notranslate nohighlight">
\[c = \frac{\Re[\mathbf{a}\cdot \mathbf{b}]}{||\mathbf{b}||^2}\]</div>
<p>In order to do all this, we need a common <em>x</em>-axis that
we can use for correlation, etc.
Here, we look for the fields that are furthest left and furthest right,
and for the smallest spacing between field samples
– we use these values to construct a (therefore all-inclusive) x axis.</p>
<p>Also, for the purposes of dot-product scaling,
it is better to scale the less noisy spectrum
(<span class="math notranslate nohighlight">\(\mathbf{b}\)</span> above)
relative to the noisier spectrum
(<span class="math notranslate nohighlight">\(\mathbf{a}\)</span> above)
– <em>i.e.</em> above, we want <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> to be less noisy.
Here, we simply find the largest spectrum in the group
(assuming it is least noisy) and use it as <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">param correlation_slice<span class="colon">:</span></dt>
<dd class="field-odd"><p>This should ONLY be needed for VERY
different spectra – e.g. pure MTSL vs.
a protein – where without it, the
different hyperfines show up out of
register.
You can look at the correlation plot,
and select a range of shifts for it to
find a max over.</p>
</dd>
<dt class="field-even">type correlation_slice<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple default None</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.apod_matched_filter">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">apod_matched_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convolve_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ret_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.apod_matched_filter" title="Link to this definition">¶</a></dt>
<dd><section id="id2">
<h3>Apodization Matched Filter<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p>This function finds a
Gaussian or Lorentzian lineshape whose
linewidth matches that of the data, then
multiplies the data by this matched-width
lineshape, ultimately returning an
apodized version of the input data .</p>
<dl class="simple">
<dt>axis: str</dt><dd><p>find matched filter along <cite>axisname</cite></p>
</dd>
<dt>convolve_method: str</dt><dd><p>specify as one of the following 2 options:
* Option 1 - ‘gaussian’
finds a matched-filter Gaussian to the
input data
* Option 2 - ‘lorentzian’
finds a matched-filter Lorentzian to the
input data</p>
</dd>
<dt>ret_width: float</dt><dd><p>returns the linewidth found for the matched filter, typically not necessary</p>
</dd>
<dt>fl: None or figlist_var()</dt><dd><p>to show diagnostic plots, set <cite>fl</cite> to the
figure list; set <cite>fl</cite> to None in order not
to see any diagnostic plots</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.calc_baseline">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">calc_baseline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">this_d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ph1lim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.calc_baseline" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the baseline for an FID-like spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this_d</strong> (<em>nddata</em>) – complex data that needs baseline</p></li>
<li><p><strong>ph1lim</strong> (<em>range</em><em> of </em><em>ph1 dimension used</em>) – </p></li>
<li><p><strong>npts</strong> (<em>integer for shape</em><em> of </em><em>array</em>) – </p></li>
<li><p><strong>guess</strong> (<em>guessed baseline array</em><em> or </em><em>None</em>) – if None will fill array shape given with
zeroes. If guess then will fill shape given
with guess.</p></li>
<li><p><strong>show_plots</strong> (<em>True</em><em> or </em><em>False</em>) – If the plots are wanted set to True.
This will add a plot called “try
baseline correction” for before and
after the baseline correction</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>phcorr0</strong> (<em>zeroth order phase correction</em>)</p></li>
<li><p><strong>phcorr1</strong> (<em>first order phase correction</em>)</p></li>
<li><p><strong>baseline</strong> (<em>generated baseline in form of array</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.center_echo">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">center_echo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">echo_center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.center_echo" title="Link to this definition">¶</a></dt>
<dd><p>Centers data around echo center given, and applies
a zeroth order phase correction.</p>
<p>Will generate an error if the echo appears to be extremely lopsided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>echo_center</strong> (<em>float</em>) – center of echo</p></li>
<li><p><strong>axis</strong> (<em>str</em>) – axis along which the echo is being centered</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.clock_correct">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">clock_correct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indirect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vd'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.clock_correct" title="Link to this definition">¶</a></dt>
<dd><p>Do clock correction.</p>
<p>On spincore, the Tx carrier (clock) and Rx carrier do not seem to be
exactly the same.
This can be proven with a simple experiment that involves changing
the time between phase reset and the start of the pulses.
It is subtle, so it only affects things with longer delays, like T₁
measurements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>nddata</em>) – The data to be corrected.</p></li>
<li><p><strong>indirect</strong> (<em>str</em>) – The dimension along which to clock correct.</p></li>
<li><p><strong>fl</strong> (<em>figlist</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>s</strong> – modified in-place</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nddata</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.convert_to_power">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">convert_to_power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'log'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directional_coupler_dB</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">22</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.convert_to_power" title="Link to this definition">¶</a></dt>
<dd><p>Generate power axis for ODNP/E(p)/FIR experiments, converts instrument
power log to useable axis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>nddata</em>) – This is an nddata whose “indirect”
axis is a structured array.  This structured array gives the
<cite>start_times</cite> and <cite>stop_times</cite> (as fields) for each datapoint
along the indirect axis.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – Name of the hdf file that contains the power log.</p></li>
<li><p><strong>exp_type</strong> (<em>str</em>) – The “experiment type” used to search for the file.
directional_coupler_dB : float
The ratio (in dB) of the power that leaves the main port of the
directional coupler vs. the power that arrives at the power
detector.  This is measured, and the value here is a previously
measured value for our system.</p></li>
<li><p><strong>fl</strong> (<em>figlist_var</em><em>(</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>values</strong> (<em>numpy.array</em>)</p></li>
<li><p><strong>s</strong> (<em>nddata</em>) – (modified in-place)
When we’re done, the axis coordinates for “indirect” are a (not
structured) array containing the average power recorded on the
log between each start_time and stop_time.
The axis coordinate errors are the standard deviations of the
same.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.correl_align">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">correl_align</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s_orig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_phases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indirect_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'indirect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'correlation</span> <span class="pre">alignment'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_pathway</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'ph1':</span> <span class="pre">0,</span> <span class="pre">'ph2':</span> <span class="pre">1}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.correl_align" title="Link to this definition">¶</a></dt>
<dd><p>Align transients collected with chunked phase cycling dimensions along an
indirect dimension based on maximizing the correlation across all the
transients and repeat alignment until the calculated signal energy remains
constant to within a given tolerance level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s_orig</strong> (<em>psd.nddata</em>) – A psd.nddata object which contains phase cycle dimensions and an
indirect dimension.</p></li>
<li><p><strong>align_phases</strong> (<em>boolean</em>) – </p></li>
<li><p><strong>tol</strong> (<em>float</em>) – Sets the tolerance limit for the alignment procedure.</p></li>
<li><p><strong>indirect_dim</strong> (<em>str</em>) – Name of the indirect dimension along which you seek to
align
the transients.</p></li>
<li><p><strong>fig_title</strong> (<em>str</em>) – Title for the figures generated.</p></li>
<li><p><strong>signal_pathway</strong> (<em>dict</em>) – Dictionary containing the signal pathway.</p></li>
<li><p><strong>shift_bounds</strong> (<em>boolean</em>) – Keeps f_shift to be within a specified
limit (upper and lower bounds given by max_shift)
which should be around the location of the expected
signal.</p></li>
<li><p><strong>avg_dim</strong> (<em>str</em>) – Dimension along which the data is being averaged.</p></li>
<li><p><strong>max_shift</strong> (<em>float</em>) – Specifies the upper and lower bounds to the range over
which f_shift will be taken from the correlation function.
Shift_bounds must be True.</p></li>
<li><p><strong>sigma</strong> (<em>int</em>) – Sigma value for the Gaussian mask. Related to the line
width of the given data.</p></li>
<li><p><strong>fl</strong> (<em>boolean</em>) – fl=fl to show the plots and figures produced by this
function otherwise, fl=None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>f_shift</strong> (<em>np.array</em>) – The optimized frequency shifts for each transient which will
maximize their correlation amongst each other, thereby aligning
them.</p></li>
<li><p><strong>sigma</strong> (<em>float</em>) – The width of the Gaussian function used to frequency filter
the data in the calculation of the correlation function.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.dBm2power">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">dBm2power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dBm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.dBm2power" title="Link to this definition">¶</a></dt>
<dd><p>convert from dBm to W</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.decay">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">decay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indirect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'indirect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.decay" title="Link to this definition">¶</a></dt>
<dd><p>Take phased data, slice and integrate it in order to fit a T2 decay curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>direct</strong> (<em>str</em>) – name of the direct dimension</p></li>
<li><p><strong>indirect</strong> (<em>str</em>) – name of the indirect dimension, along which the recovery is measured</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>f</strong> (<em>fitdata</em>) – the full fitdata object with all info about the fit curve</p></li>
<li><p><strong>T1</strong> (<em>float</em>) – just the T1 relaxation time</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.determine_sign">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">determine_sign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_freq_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_pathway</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.determine_sign" title="Link to this definition">¶</a></dt>
<dd><p>Determines the sign of the signal based on the difference between the
signal with the zeroth order phase correction applied to the entire data
set vs applying the zeroth order phase correction to each individual
indirect index.  The sign can be used, so that when multiplied by the
signal the data has a uniform
sign along the indirect axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>nddata</em>) – Data with a single (dominant) peak, where you want to return the sign
of the integral over all the data.</p></li>
<li><p><strong>signal_freq_range</strong> (<em>tuple</em>) – Narrow slice range where signal resides.</p></li>
<li><p><strong>direct</strong> (<em>str</em><em> (</em><em>default &quot;t2&quot;</em><em>)</em>) – Name of the direct dimension.</p></li>
<li><p><strong>signal_pathway</strong> (<em>dict</em><em> (</em><em>default None</em><em>)</em>) – If None, the function will go into the properties of the data looking
for the “coherence_pathway” property. If that doesn’t exist the user
needs to feed a dictionary containing the coherence transfer pathway
where the signal resides.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>mysign</strong> – A dataset with all +1 or -1 (giving the sign of the original signal).
Does <em>not</em> include the <cite>direct</cite> dimension.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nddata</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.draw_limits">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">draw_limits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thisrange</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.draw_limits" title="Link to this definition">¶</a></dt>
<dd><p>determines the range of the t2 axis and pairs it with the range given
returns the x axis limits for plotting</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thisrange</strong> (<em>tuple</em><em> of </em><em>2 floats</em>) – slice range you are interested in extending</p></li>
<li><p><strong>s</strong> (<em>nddata</em>) – the data you are planning on slicing</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>the limits for the t2 axis for plotting purposes</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.expand_limits">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">expand_limits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thisrange</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.expand_limits" title="Link to this definition">¶</a></dt>
<dd><p>“ Used to expand limits of a range (typically used for slicing) by 3X</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thisrange</strong> (<em>tuple</em><em> of </em><em>2 floats</em>) – slice range you are interested in extending</p></li>
<li><p><strong>s</strong> (<em>nddata</em>) – the data you are planning on slicing</p></li>
<li><p><strong>axis</strong> (<em>str</em>) – name of the axis along which the slice range will be applied</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>retval</strong> – the expanded range</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of 2 floats</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.fid_from_echo">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">fid_from_echo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_pathway</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_rising</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_rising</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_multiplier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_lower_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_hermitian_sign_flipped</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_shifted_residuals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frq_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frq_half</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.fid_from_echo" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal_pathway</strong> (<em>dict</em>) – coherence transfer pathway that correspond to the signal</p></li>
<li><p><strong>fl</strong> (<em>figlist</em><em> or </em><em>None</em><em> (</em><em>default</em><em>)</em>) – If you want the diagnostic plots (showing the distribution of the
data in the complex plane), set this to your figlist object.</p></li>
<li><p><strong>add_rising</strong> (<em>boolean</em>) – Take the first part of the echo (that which rises to the maximum)
and add the decaying (FID like) part. This increases the SNR of
the early points of the signal.</p></li>
<li><p><strong>direct</strong> (<em>string</em>) – Name of the direct dimension</p></li>
<li><p><strong>exclude_rising</strong> (<em>int</em>) – In general it is assumed that the first few points of signal
might be messed up due to dead time or other issues (assuming a
tau of 0).  This option allows us to add a rising edge to the
echo and exclude the first few points of the signal. Note, to use
this, add_rising must be True.</p></li>
<li><p><strong>slice_multiplier</strong> (<em>int</em>) – The calculated frequency slice is calculated by taking the center
frequency and extending out to values that are included in the
peak times this multiplier. Therefore the larger this value the
larger the frequency slice. Increasing this value might serve
useful in the case of noisy spectra.</p></li>
<li><p><strong>peak_lower_thresh</strong> (<em>float</em>) – Fraction of the signal intensity used in calculating the
frequency slice. The smaller the value, the wider the slice.</p></li>
<li><p><strong>show_hermitian_sign_flipped</strong> (<em>boolean</em>) – Diagnostic in checking the sign of the signal prior to the
hermitian phase correction</p></li>
<li><p><strong>show_shifted_residuals</strong> (<em>boolean</em>) – Diagnostic in analyzing the residuals after the hermitian phase
correction.</p></li>
<li><p><strong>frq_center</strong> (<em>float</em><em> (</em><em>default None</em><em>)</em>) – The center of the peak.
This only exists so that we don’t end up calling
<cite>find_peakrange</cite> redundantly,
and it should come from a previous call to <cite>find_peakrange</cite> if
it’s used.</p></li>
<li><p><strong>frq_half</strong> (<em>float</em><em> (</em><em>default None</em><em>)</em>) – The half-width of the peak.
This only exists so that we don’t end up calling
<cite>find_peakrange</cite> redundantly,
and it should come from a previous call to <cite>find_peakrange</cite> if
it’s used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>d</strong> – FID of properly sliced and phased signal</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nddata</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.find_apparent_anal_freq">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">find_apparent_anal_freq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.find_apparent_anal_freq" title="Link to this definition">¶</a></dt>
<dd><p>A function to identify the position of analytic signal as acquired on the oscilloscope.
Importantly this function takes into account the effects of aliasing in identifying the
frequency of the resulting signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>s</strong> (<em>nddata</em>) – data with a single (dominant) peak, where you want to identify the frequency.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>s</strong> (<em>nddata</em>) – The original data that was initially fed to the function</p></li>
<li><p><strong>nu_a</strong> (<em>float</em>) – The apparent frequency of the signal</p></li>
<li><p><strong>isflipped</strong> (<em>boolean</em>) – If aliased from a negative frequency, this notes whether the phase
of the final time domain signal will be flipped</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.find_peakrange">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">find_peakrange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_lower_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.find_peakrange" title="Link to this definition">¶</a></dt>
<dd><p>find the range of frequencies over which the signal occurs, so that we
can autoslice</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>nddata</em>) – Data in the frequency domain – will not be altered.</p></li>
<li><p><strong>direct</strong> (<em>str</em><em> (</em><em>default &quot;t2&quot;</em><em>)</em>) – The name of the direct dimension</p></li>
<li><p><strong>peak_lower_thresh</strong> (<em>float</em>) – Fraction of the signal intensity used in calculating the
frequency slice. The smaller the value, the wider the slice.</p></li>
<li><p><strong>fl</strong> (<em>figlist</em><em> (</em><em>default None</em><em>)</em>) – If you want to see diagnostic plots, feed the figure list.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>frq_center</strong> (<em>float</em>) – The midpoint of the frequency slice.</p></li>
<li><p><strong>frq_half</strong> (<em>float</em>) – Half the width of the frequency slice.
Given in this way, so you can easily do
&gt;&gt;&gt; newslice = r_[-expansino,expansion]*frq_half+frq_center</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.fit_envelope">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">fit_envelope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8.434</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'envelope'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_expanding_envelope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.fit_envelope" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyspecProcScripts.fl_mod">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">fl_mod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.fl_mod" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">figlist</span></code></p>
<p>Extends figlist_var with various new convenience functions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyspecProcScripts.fl_mod.complex_plot">
<span class="sig-name descname"><span class="pre">complex_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_real</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.fl_mod.complex_plot" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyspecProcScripts.fl_mod.next">
<span class="sig-name descname"><span class="pre">next</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.fl_mod.next" title="Link to this definition">¶</a></dt>
<dd><p>Switch to the figure given by input_name, which is used not only as
a string-based name for the figure, but also as a default title and as
a base name for resulting figure files.</p>
<p><strong>In the future, we actually want this to track the appropriate axis
object!</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>legend</strong> (<em>bool</em>) – If this is set, a legend is created <em>outside</em> the figure.</p></li>
<li><p><strong>twinx</strong> (<em>{0</em><em>,</em><em>1}</em>) – <dl class="field-list simple">
<dt class="field-odd">1<span class="colon">:</span></dt>
<dd class="field-odd"><p>plots on an overlayed axis (the matplotlib twinx) whose y axis
is labeled on the right when you set this for the first time,
you can also set a <cite>color</cite> kwarg that controls the coloring of
the right axis.</p>
</dd>
<dt class="field-even">0<span class="colon">:</span></dt>
<dd class="field-even"><p>used to switch back to the left (default) axis</p>
</dd>
</dl>
</p></li>
<li><p><strong>boundaries</strong> – <strong>need to add description</strong></p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – Any other keyword arguments are passed to the matplotlib (mayavi)
figure() function that’s used to switch (create) figures.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyspecProcScripts.fl_mod.plot_curve">
<span class="sig-name descname"><span class="pre">plot_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.fl_mod.plot_curve" title="Link to this definition">¶</a></dt>
<dd><p>Plot the data with fit curve and fit equation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>fitdata</em>) – data (a fitting instance), on which <cite>f.fit()</cite> has already been run</p></li>
<li><p><strong>guess</strong> (<em>None</em><em> or </em><em>nddata</em>) – The result of <cite>s.settoguess();s.eval(100)</cite> where 100 can be
any integer.
Used to display the guess on the plot as well.</p></li>
<li><p><strong>name</strong> (<em>str</em>) – the name of the plot</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyspecProcScripts.fl_mod.real_imag">
<span class="sig-name descname"><span class="pre">real_imag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plotname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.fl_mod.real_imag" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyspecProcScripts.fl_mod.side_by_side">
<span class="sig-name descname"><span class="pre">side_by_side</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plotname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thisrange</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.fl_mod.side_by_side" title="Link to this definition">¶</a></dt>
<dd><p>a bit of a hack to get the two subplots into
the figure list – also a good test for objective
figure list – for each slice out 3x thisrange, and then
show the lines for thisrange</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.fwhm_calculator">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">fwhm_calculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.fwhm_calculator" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.generate_integrals">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">generate_integrals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">searchstr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_pathway</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'ph1':</span> <span class="pre">0,</span> <span class="pre">'ph2':</span> <span class="pre">1}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">excluded_pathways</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[(0,</span> <span class="pre">0)]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indirect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'indirect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alias_slop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clock_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_bars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correlate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.generate_integrals" title="Link to this definition">¶</a></dt>
<dd><p>Applies appropriate phase corrections, along with DC offset corrections,
alignment, and integrates the data to transform 2D datasets into a table
of integrals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>searchstr</strong> (<em>str</em>) – string for the title of the plots produced.</p></li>
<li><p><strong>signal_pathway</strong> (<em>dict</em>) – Dictionary of the path of the desired signal.</p></li>
<li><p><strong>excluded_pathways</strong> (<em>dict</em>) – Dictionary of all coherence pathways that are not
the signal pathway.</p></li>
<li><p><strong>f_range</strong> (<em>tuple</em>) – Frequency range over which the signal resides.</p></li>
<li><p><strong>direct</strong> (<em>str</em>) – Direct dimension of the signal</p></li>
<li><p><strong>indirect</strong> (<em>str</em>) – Indirect dimension of the signal. Usually ‘power’ or
‘nScans’ for example.</p></li>
<li><p><strong>alias_slop</strong> (<em>int</em>) – Aliasing_slop used in the hermitian function.</p></li>
<li><p><strong>clock_correction</strong> (<em>bool</em>) – If true, will apply a clock correction. Is needed for
IR but not enhancement data.</p></li>
<li><p><strong>error_bars</strong> (<em>bool</em>) – Option to apply integration <em>with</em> error bars.</p></li>
<li><p><strong>correlate</strong> (<em>bool</em>) – Option to apply correlation alignment to data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>s</strong> (<em>psd.nddata</em>) – Data with applied corrections but <em>not</em> integrated</p></li>
<li><p><strong>s_int</strong> (<em>psd.nddata</em>) – Integrated and corrected data</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.hermitian_function_test">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">hermitian_function_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aliasing_slop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_extended</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.98</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_threshold_lower</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_refinement</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.hermitian_function_test" title="Link to this definition">¶</a></dt>
<dd><p>Determine the center of the echo via hermitian symmetry of the time
domain.</p>
<p>Note the following issues/feature:</p>
<ul class="simple">
<li><p>Data <em>must</em> start at t=0 (due to the way that we calculate the energy
term in the expression)</p></li>
<li><p>Data typically has a rising edge, which can lead to ringing.
Therefore, we apply a Tukey filter to the data.  Because this
suppresses the edges in frequency space, you will likely want to slice
a slightly wider bandwidth than you are interested in.</p></li>
<li><p>If you have an initial portion of signal that has very low SNR (i.e. if
your echo time is long relative to <span class="math notranslate nohighlight">\(T_2^*\)</span>), that will affect the
SNR of the cost function.  Trailing noise will not affect the SNR of
the cost function, only lead to slightly longer calculation times.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>direct</strong> (<em>str</em>) – Axis of data (i.e., direct dimension).</p></li>
<li><p><strong>energy_threshold</strong> (<em>float</em>) – To avoid picking a minimum that’s based off of very little data, only
recognize the cost function over an interval where the normalized
energy function is equal to <cite>energy_threshold</cite> of its max value.</p></li>
<li><p><strong>aliasing_slop</strong> (<em>int</em><em> (</em><em>default 3</em><em>)</em>) – The signal typically has an initial rising
portion where – even due to FIR or
instrumental filters in the raw data,
the signal has some kind of Gibbs ringing in the
transition between signal an zero.
This portion of the signal will not mirror the
signal on the other side of the echo, and
should not even be included in the cost
function!
We believe the most consistent way to specify
the amount of signal that should be excluded as
an number of datapoints, hence why we ask for
an integer here.</p></li>
<li><p><strong>enable_refinement</strong> (<em>boolean</em>) – Do not use – an attempt to correct for cases where we don’t get
the lowest residual out of the Fourier technique.
The idea was that this was based on the fact that the correlation
function is calculated between the two upsampled (sinc
interpolated) functions, and so we should explicitly calculate
the residual in the original resolution.
But, there appears to be an error that would need to be debugged
– fails some of the basic tests, and the residual does not
always appear to be the lowest.</p></li>
<li><p><strong>todo::</strong> (<em>..</em>) – AG fix docstring + cite coherence paper</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.integral_w_errors">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">integral_w_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convolve_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indirect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_frq_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.integral_w_errors" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the propagation of error for the given signal and returns
signal with the error associated.</p>
<p>Before declaring the error_path,
look at an examples such as integration_w_error.py to see how to
decide which excluded pathways to take the error over.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sig_path</strong> (<em>dict</em>) – Dictionary of the path of the desired signal.</p></li>
<li><p><strong>error_path</strong> (<em>dict</em>) – <p>Dictionary of all coherence pathways that are
not the signal pathway.</p>
<p>Before declaring the error_path,
look at an examples such as integration_w_error.py to
see how to decide which excluded pathways to take the
error over.</p>
</p></li>
<li><p><strong>convolve_method</strong> (<em>str</em>) – method of convolution used in integrating limits
passed on to <a class="reference internal" href="#pyspecProcScripts.integrate_limits" title="pyspecProcScripts.integrate_limits"><code class="xref py py-func docutils literal notranslate"><span class="pre">integrate_limits()</span></code></a></p></li>
<li><p><strong>indirect</strong> (<em>str</em>) – Indirect axis.</p></li>
<li><p><strong>direct</strong> (<em>str</em>) – Direct axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>s</strong> – Data with error associated with coherence pathways
not included in the signal pathway.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nddata</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.integrate_limits">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">integrate_limits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convolve_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.integrate_limits" title="Link to this definition">¶</a></dt>
<dd><p>This function takes data in the frequency
domain and finds the corresponding frequency
limits of the signal for integration.</p>
<p>Limits are found by applying a matched filter
(choice of Lorentzian or Gaussian <code class="docutils literal notranslate"><span class="pre">convolve_method</span></code>) to the
frequency domain data, which it then uses to
determine the integration limits based on a
<code class="docutils literal notranslate"><span class="pre">cutoff</span></code> amplitude based as a fraction of the maximum signal intensity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>str</em>) – apply convolution along <cite>axisname</cite></p></li>
<li><p><strong>convolve_method</strong> (<em>str</em>) – specify as one of the following 3 options:
* Option 1 - ‘gaussian’
to calculate the matched-filter via
Gaussian convolution of the frequency
domain signal.
* Option 2 - ‘lorentzian’
to calculate the matched-filter via
Lorentzian convolution of the frequency
domain signal.</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>) – set the integration limit to the points where the convolved signal
crosses this fraction of its maximum.
(e.g. cutoff=0.5 would give integration limits that correspond to the
frequencies marking the full width half maximum of the convolution of
the signal and its matched filter)</p></li>
<li><p><strong>fl</strong> (<em>None</em><em> or </em><em>figlist_var</em><em>(</em><em>)</em>) – to show diagnostic plots, set <cite>fl</cite> to the figure list; set <cite>fl</cite> to None in
order not to see any diagnostic plots</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyspecProcScripts.logobj">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">logobj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.logobj" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyspecProcScripts.logobj.from_group">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h5group</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.logobj.from_group" title="Link to this definition">¶</a></dt>
<dd><p>initialize a new log object with data loaded from the h5py group
h5group (factory method</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyspecProcScripts.logobj.total_log">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_log</span></span><a class="headerlink" href="#pyspecProcScripts.logobj.total_log" title="Link to this definition">¶</a></dt>
<dd><p>the log is stored internally as a list of arrays – here return a single array for the whole log</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.ph1_real_Abs">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">ph1_real_Abs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ph1_sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ph2_sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.ph1_real_Abs" title="Link to this definition">¶</a></dt>
<dd><p>Performs first order phase correction with cost function
by taking the sum of the absolute value of the real [DeBrouwer2009].</p>
<div class="admonition-todo admonition" id="id4">
<p class="admonition-title">Todo</p>
<p>update with <a class="reference external" href="https://sphinxcontrib-bibtex.readthedocs.io/en/latest/usage.html">sphinxcontrib-bibtex</a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>s</strong> (<em>nddata</em>) – Complex data whose first order phase you want
to find.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>retval</em></p></li>
<li><p><strong>.. rubric</strong> (<em>References</em>)</p></li>
<li><p><em>..  [DeBrouwer2009] de Brouwer, H. (2009). Evaluation of algorithms for</em> – automated phase correction of NMR spectra. Journal of Magnetic
Resonance (San Diego, Calif. : 1997), 201(2), 230–238.
<a class="reference external" href="https://doi.org/10.1016/j.jmr.2009.09.017">https://doi.org/10.1016/j.jmr.2009.09.017</a></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.power2dBm">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">power2dBm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">power</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.power2dBm" title="Link to this definition">¶</a></dt>
<dd><p>convert from W to dBm</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.recovery">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">recovery</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indirect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'indirect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.recovery" title="Link to this definition">¶</a></dt>
<dd><p>Take phased data, slice and integrate it in order to fit an inversion recovery curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>direct</strong> (<em>str</em>) – name of the direct dimension</p></li>
<li><p><strong>indirect</strong> (<em>str</em>) – name of the indirect dimension, along which the recovery is measured</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>f</strong> (<em>fitdata</em>) – the full fitdata object with all info about the fit curve</p></li>
<li><p><strong>T1</strong> (<em>float</em>) – just the T1 relaxation time</p></li>
<li><p><strong>save_guess</strong> (<em>nddata</em>) – returned only if the guess argument is set.
Give an nddata with all parameters set to the guess value.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.rough_table_of_integrals">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">rough_table_of_integrals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_pathway</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">echo_like</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expansion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_lower_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc_plot_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.rough_table_of_integrals" title="Link to this definition">¶</a></dt>
<dd><p>manipulate s to generate a table of integrals
(with only rough alignment)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>nddata</em>) – Data with a single (dominant) peak, where you want to return the sign
of the integral over all the data.</p></li>
<li><p><strong>signal_range</strong> (<em>tuple</em><em> (</em><em>default None</em><em>)</em>) – <p>Narrow slice range where signal resides.
You probably want to get this from <cite>find_peakrange</cite> rather than trying
to specify manually!
(And expand the range that it gives you slightly)</p>
<p>If this is set to the string <cite>‘peakrange’</cite>,
it assumes a previous call to <cite>find_peakrange</cite>
has set the
<cite>‘peakrange’</cite> property, and it uses that.</p>
<p>If this is set to None, then it assume you want to call
<cite>find_peakrange</cite></p>
</p></li>
<li><p><strong>signal_pathway</strong> (<em>dict</em><em> (</em><em>default None</em><em>)</em>) – If None, the function will go into the properties of the data looking
for the “coherence_pathway” property.
If that doesn’t exist the user needs to feed a dictionary containing
the coherence transfer pathway where the signal resides.
If the signal has already been sliced along the coherence dimensions,
you can feed an empty dictionary (note the <em>very</em> different behavior
<em>vs</em> <cite>None</cite>)</p></li>
<li><p><strong>echo_like</strong> (<em>boolean</em>) – If the signal has an echo the <cite>fid_from_echo</cite> function will be applied
prior to integration to apply the FID slice as well as proper phasing
and peak selection.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – Title for the returned figure.</p></li>
<li><p><strong>direct</strong> (<em>str</em><em> (</em><em>default &quot;t2&quot;</em><em>)</em>) – Name of direct dimension.</p></li>
<li><p><strong>expansion</strong> (<em>float</em><em> (</em><em>default 2</em><em>)</em>) – Expand peakrange about its center by this much.</p></li>
<li><p><strong>peak_lower_thresh</strong> (<em>float</em>) – passed to <a class="reference internal" href="#pyspecProcScripts.find_peakrange" title="pyspecProcScripts.find_peakrange"><code class="xref py py-func docutils literal notranslate"><span class="pre">find_peakrange()</span></code></a></p></li>
<li><p><strong>inc_plot_color</strong> (<em>boolean</em>) – assume that we are processing multiple datasets, and want to increment
the color counter with every run of this function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>s</strong> (<em>nddata</em>) – The table of integrals (collapse the direct dimension into a single
number).
Processing is done in place.</p></li>
<li><p><strong>ax4</strong> (<em>Axes</em>) – Return the axis with the table of integrals (plotted as <cite>“o”</cite>), in case
you want to add a fit!</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.select_pathway">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">select_pathway</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.select_pathway" title="Link to this definition">¶</a></dt>
<dd><p>select a particular CT pathway from the signal <cite>s</cite></p>
<p>Arguments are <em>either</em> <code class="docutils literal notranslate"><span class="pre">pathway</span></code> – a dict of key/value pairs indicating
the pathway <strong>or</strong> the same set of key/value pairs, just passed as a dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>nddata</em>) – the data whose coherence pathway you would like to select</p></li>
<li><p><strong>pathway</strong> (<em>dict</em>) – keys are the names of the coherence transfer dimensions (conj. of phase
cycling dimensions) and values are the pathway you want to select</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.slice_FID_from_echo">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">slice_FID_from_echo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_pathway</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'ph1':</span> <span class="pre">1,</span> <span class="pre">'ph2':</span> <span class="pre">-2}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.slice_FID_from_echo" title="Link to this definition">¶</a></dt>
<dd><p>Automatically slices the FID out of an echo.</p>
<p>Determines the proper position for <span class="math notranslate nohighlight">\(t=0\)</span> from hermitian function test.
This is followed by zeroth order phase correcting and slicing from the center of
the echo (<span class="math notranslate nohighlight">\(t=0\)</span> onward to the t_range defined</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_t</strong> (<em>int</em>) – where the slice ends in the time domain.</p></li>
<li><p><strong>ph1</strong> (<em>int</em>) – the selection of ph1 in the coherence pathway</p></li>
<li><p><strong>ph2</strong> (<em>int</em>) – selection of ph2 in coherence pathway</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>s</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>phase corrected and sliced data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyspecProcScripts.zeroth_order_ph">
<span class="sig-prename descclassname"><span class="pre">pyspecProcScripts.</span></span><span class="sig-name descname"><span class="pre">zeroth_order_ph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyspecProcScripts.zeroth_order_ph" title="Link to this definition">¶</a></dt>
<dd><p>determine the moment of inertial of the datapoints
in complex plane, and use to phase the
zeroth-order even if the data is both negative
and positive.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>nddata</em>) – Complex data whose zeroth order phase you want
to find.</p></li>
<li><p><strong>fl</strong> (<em>figlist</em><em> or </em><em>None</em><em> (</em><em>default</em><em>)</em>) – If you want the diagnostic plots (showing the
distribution of the data in the complex plane),
set this to your figlist object.
It will add a plot called “check covariance
test”</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>retval</strong> – The zeroth order phase of the data, as a
complex number with magnitude 1.
To correct the zeroth order phase of the data,
divide by <code class="docutils literal notranslate"><span class="pre">retval</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>complex128</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.png" alt="Logo" />
    
  </a>
</p>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Example Gallery</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">ProcScripts Example Gallery</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2021, John M. Franck group.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../_sources/auto_api/pyspecProcScripts.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>