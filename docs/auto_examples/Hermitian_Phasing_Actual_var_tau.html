<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Phasing and Timing Correction Using a Varied Tau Experiment &mdash; pyspecProcScripts 0.9 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-rendered-html.css" type="text/css" />
      <link rel="stylesheet" href="../_static/gallery_custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Demonstrate Integrate Limits" href="integrate_limits.html" />
    <link rel="prev" title="Demonstrate Integrate Limits on Experimental Data" href="integrate_limits_realData.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> pyspecProcScripts
          </a>
              <div class="version">
                0.9
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Lowest level</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro.html#first-level-in-this-repo">First level in this repo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro.html#second-level-in-this-repo">Second level in this repo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro.html#top-level">Top level</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Example Gallery</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">ProcScripts Example Gallery</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="proc_square_refl.html">Process a square wave reflection</a></li>
<li class="toctree-l2"><a class="reference internal" href="generate_integrals_RealData.html">Convert 2D  Real Data into Integrals with Errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="proc_var_tau.html">Echoes with varied tau lengths</a></li>
<li class="toctree-l2"><a class="reference internal" href="L2G.html">Lorentzian to Gaussian Transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="integrate_limits_realData.html">Demonstrate Integrate Limits on Experimental Data</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Phasing and Timing Correction Using a Varied Tau Experiment</a></li>
<li class="toctree-l2"><a class="reference internal" href="integrate_limits.html">Demonstrate Integrate Limits</a></li>
<li class="toctree-l2"><a class="reference internal" href="Hermitian_Phasing_Actual_Challenging.html">Phasing and Timing Correction with Real Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="generate_integrals.html">Convert 2D to Integrals with Errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="proc_capture_nutation.html">Captured Nutation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Hermitian_Phasing.html">Phasing and Timing Correction With Fake Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="check_integration_error.html">Check integral error calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="correlation_alignment_example.html">Align data with significant frequency drift</a></li>
<li class="toctree-l2"><a class="reference internal" href="proc_fieldSweep.html">Check NMR/ESR resonance ratio using a field sweep</a></li>
<li class="toctree-l2"><a class="reference internal" href="integration_with_error.html">Check Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_error.html">Validate Inactive CT Error</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pyspecProcScripts</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">ProcScripts Example Gallery</a></li>
      <li class="breadcrumb-item active">Phasing and Timing Correction Using a Varied Tau Experiment</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/auto_examples/Hermitian_Phasing_Actual_var_tau.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-hermitian-phasing-actual-var-tau-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="phasing-and-timing-correction-using-a-varied-tau-experiment">
<span id="sphx-glr-auto-examples-hermitian-phasing-actual-var-tau-py"></span><h1>Phasing and Timing Correction Using a Varied Tau Experiment<a class="headerlink" href="#phasing-and-timing-correction-using-a-varied-tau-experiment" title="Permalink to this heading">¶</a></h1>
<p>Take real data with varying echo times,
and demonstrate how we can automatically find the zeroth order phase and the
center of the echo in order to get data that’s purely real in the frequency
domain.</p>
<p>Here, we specifically check to see whether or not the offset between the
programmed τ and the center of the echo
(as found by <code class="xref py py-func docutils literal notranslate"><span class="pre">hermitian_function_test()</span></code>)
is consistent.</p>
<ul class="sphx-glr-horizontal">
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_001.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_001.png" alt="Hermitian Diagnostic 10.7 ms, Data with Padding, shifted and phased, Residual 2D, cropped log of Masked Residual" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_002.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_002.png" alt="10.7 ms cost function triangular mask - freq filter, 10.7 ms cost function triangular mask - freq filter" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_003.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_003.png" alt="Hermitian Diagnostic 15.7 ms, Data with Padding, shifted and phased, Residual 2D, cropped log of Masked Residual" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_004.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_004.png" alt="15.7 ms cost function triangular mask - freq filter, 15.7 ms cost function triangular mask - freq filter" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_005.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_005.png" alt="Hermitian Diagnostic 20.7 ms, Data with Padding, shifted and phased, Residual 2D, cropped log of Masked Residual" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_006.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_006.png" alt="20.7 ms cost function triangular mask - freq filter, 20.7 ms cost function triangular mask - freq filter" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_007.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_007.png" alt="Hermitian Diagnostic 25.7 ms, Data with Padding, shifted and phased, Residual 2D, cropped log of Masked Residual" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_008.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_008.png" alt="25.7 ms cost function triangular mask - freq filter, 25.7 ms cost function triangular mask - freq filter" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_009.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_009.png" alt="Hermitian Diagnostic 30.7 ms, Data with Padding, shifted and phased, Residual 2D, cropped log of Masked Residual" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_010.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_010.png" alt="30.7 ms cost function triangular mask - freq filter, 30.7 ms cost function triangular mask - freq filter" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_011.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_011.png" alt="Hermitian Diagnostic 35.7 ms, Data with Padding, shifted and phased, Residual 2D, cropped log of Masked Residual" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_012.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_012.png" alt="35.7 ms cost function triangular mask - freq filter, 35.7 ms cost function triangular mask - freq filter" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_013.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_013.png" alt="Hermitian Diagnostic 40.7 ms, Data with Padding, shifted and phased, Residual 2D, cropped log of Masked Residual" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_014.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_014.png" alt="40.7 ms cost function triangular mask - freq filter, 40.7 ms cost function triangular mask - freq filter" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_015.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_015.png" alt="Hermitian Diagnostic 45.7 ms, Data with Padding, shifted and phased, Residual 2D, cropped log of Masked Residual" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_016.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_016.png" alt="45.7 ms cost function triangular mask - freq filter, 45.7 ms cost function triangular mask - freq filter" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_017.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_017.png" alt="Hermitian Diagnostic 50.7 ms, Data with Padding, shifted and phased, Residual 2D, cropped log of Masked Residual" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_018.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_018.png" alt="50.7 ms cost function triangular mask - freq filter, 50.7 ms cost function triangular mask - freq filter" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_019.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_019.png" alt="Hermitian Diagnostic 55.7 ms, Data with Padding, shifted and phased, Residual 2D, cropped log of Masked Residual" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_020.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_020.png" alt="55.7 ms cost function triangular mask - freq filter, 55.7 ms cost function triangular mask - freq filter" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_021.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_021.png" alt="Hermitian Diagnostic 60.7 ms, Data with Padding, shifted and phased, Residual 2D, cropped log of Masked Residual" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_022.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_022.png" alt="60.7 ms cost function triangular mask - freq filter, 60.7 ms cost function triangular mask - freq filter" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_023.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_023.png" alt="Hermitian Diagnostic 65.7 ms, Data with Padding, shifted and phased, Residual 2D, cropped log of Masked Residual" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_024.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_024.png" alt="65.7 ms cost function triangular mask - freq filter, 65.7 ms cost function triangular mask - freq filter" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_025.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_025.png" alt="Hermitian Diagnostic 70.7 ms, Data with Padding, shifted and phased, Residual 2D, cropped log of Masked Residual" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_026.png" srcset="../_images/sphx_glr_Hermitian_Phasing_Actual_var_tau_026.png" alt="70.7 ms cost function triangular mask - freq filter, 70.7 ms cost function triangular mask - freq filter" class = "sphx-glr-multi-img"/></li>
</ul>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>C:\Users\jmfranck\pyspecdata.0.log appears to be locked or otherwise inaccessible: I&#39;m going to explore other options for fileno
----------  logging output to C:\Users\jmfranck\pyspecdata.3.log  ----------
--&gt; Hermitian_Phasing_Actual_var_tau.py(46):pyspecdata.core             &lt;module&gt; 2023-05-13 16:25:51,650
INFO: programmed tau: 0.010676666666666666
c:\users\jmfranck\git_repos\pyspecdata\pyspecdata\core.py:1959: UserWarning: linestyle is redundantly defined by the &#39;linestyle&#39; keyword argument and the fmt string &quot;:&quot; (-&gt; linestyle=&#39;:&#39;). The keyword argument will take precedence.
  retval = myplotfunc(*plotargs,**kwargs)
c:\users\jmfranck\git_repos\pyspecdata\pyspecdata\core.py:3842: RuntimeWarning: divide by zero encountered in log10
  retval = func(self.data)
--&gt; Hermitian_Phasing_Actual_var_tau.py(54):pyspecdata.core             &lt;module&gt; 2023-05-13 16:25:52,072
INFO: best shift is: 0.010314832465961977
--&gt; Hermitian_Phasing_Actual_var_tau.py(46):pyspecdata.core             &lt;module&gt; 2023-05-13 16:25:52,073
INFO: programmed tau: 0.015676666666666665
--&gt; Hermitian_Phasing_Actual_var_tau.py(54):pyspecdata.core             &lt;module&gt; 2023-05-13 16:25:52,654
INFO: best shift is: 0.01558355984066198
--&gt; Hermitian_Phasing_Actual_var_tau.py(46):pyspecdata.core             &lt;module&gt; 2023-05-13 16:25:52,654
INFO: programmed tau: 0.020676666666666663
--&gt; Hermitian_Phasing_Actual_var_tau.py(54):pyspecdata.core             &lt;module&gt; 2023-05-13 16:25:53,414
INFO: best shift is: 0.02067913655046574
--&gt; Hermitian_Phasing_Actual_var_tau.py(46):pyspecdata.core             &lt;module&gt; 2023-05-13 16:25:53,414
INFO: programmed tau: 0.025676666666666664
--&gt; Hermitian_Phasing_Actual_var_tau.py(54):pyspecdata.core             &lt;module&gt; 2023-05-13 16:25:54,391
INFO: best shift is: 0.025502619358289683
--&gt; Hermitian_Phasing_Actual_var_tau.py(46):pyspecdata.core             &lt;module&gt; 2023-05-13 16:25:54,392
INFO: programmed tau: 0.030676666666666665
--&gt; Hermitian_Phasing_Actual_var_tau.py(54):pyspecdata.core             &lt;module&gt; 2023-05-13 16:25:55,354
INFO: best shift is: 0.03032610216611363
--&gt; Hermitian_Phasing_Actual_var_tau.py(46):pyspecdata.core             &lt;module&gt; 2023-05-13 16:25:55,354
INFO: programmed tau: 0.03567666666666666
--&gt; Hermitian_Phasing_Actual_var_tau.py(54):pyspecdata.core             &lt;module&gt; 2023-05-13 16:25:56,364
INFO: best shift is: 0.03579271601498077
--&gt; Hermitian_Phasing_Actual_var_tau.py(46):pyspecdata.core             &lt;module&gt; 2023-05-13 16:25:56,365
INFO: programmed tau: 0.04067666666666666
--&gt; Hermitian_Phasing_Actual_var_tau.py(54):pyspecdata.core             &lt;module&gt; 2023-05-13 16:25:57,410
INFO: best shift is: 0.04069040625061739
--&gt; Hermitian_Phasing_Actual_var_tau.py(46):pyspecdata.core             &lt;module&gt; 2023-05-13 16:25:57,411
INFO: programmed tau: 0.045676666666666664
--&gt; Hermitian_Phasing_Actual_var_tau.py(54):pyspecdata.core             &lt;module&gt; 2023-05-13 16:25:58,518
INFO: best shift is: 0.04464813573396012
--&gt; Hermitian_Phasing_Actual_var_tau.py(46):pyspecdata.core             &lt;module&gt; 2023-05-13 16:25:58,518
INFO: programmed tau: 0.05067666666666666
--&gt; Hermitian_Phasing_Actual_var_tau.py(54):pyspecdata.core             &lt;module&gt; 2023-05-13 16:25:59,749
INFO: best shift is: 0.050312636056994396
--&gt; Hermitian_Phasing_Actual_var_tau.py(46):pyspecdata.core             &lt;module&gt; 2023-05-13 16:25:59,750
INFO: programmed tau: 0.05567666666666666
--&gt; Hermitian_Phasing_Actual_var_tau.py(54):pyspecdata.core             &lt;module&gt; 2023-05-13 16:26:00,896
INFO: best shift is: 0.05540821276679815
--&gt; Hermitian_Phasing_Actual_var_tau.py(46):pyspecdata.core             &lt;module&gt; 2023-05-13 16:26:00,896
INFO: programmed tau: 0.060676666666666663
c:\users\jmfranck\git_repos\proc_scripts\pyspecProcScripts\phasing.py:264: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  fig_forlist, ax_list = plt.subplots(2, 2, figsize=(15, 15))
--&gt; Hermitian_Phasing_Actual_var_tau.py(54):pyspecdata.core             &lt;module&gt; 2023-05-13 16:26:01,937
INFO: best shift is: 0.060281167193163884
--&gt; Hermitian_Phasing_Actual_var_tau.py(46):pyspecdata.core             &lt;module&gt; 2023-05-13 16:26:01,937
INFO: programmed tau: 0.06567666666666667
--&gt; Hermitian_Phasing_Actual_var_tau.py(54):pyspecdata.core             &lt;module&gt; 2023-05-13 16:26:02,791
INFO: best shift is: 0.06453572638775731
--&gt; Hermitian_Phasing_Actual_var_tau.py(46):pyspecdata.core             &lt;module&gt; 2023-05-13 16:26:02,791
INFO: programmed tau: 0.07067666666666667
--&gt; Hermitian_Phasing_Actual_var_tau.py(54):pyspecdata.core             &lt;module&gt; 2023-05-13 16:26:04,098
INFO: best shift is: 0.0592917348223282
programmed tau / ms estimated tau / ms difference / ms
------------------- ------------------ ---------------
              10.68              10.31            0.36
              15.68              15.58            0.09
              20.68              20.68            0.00
              25.68              25.50            0.17
              30.68              30.33            0.35
              35.68              35.79            0.12
              40.68              40.69            0.01
              45.68              44.65            1.03
              50.68              50.31            0.36
              55.68              55.41            0.27
              60.68              60.28            0.40
              65.68              64.54            1.14
              70.68              59.29           11.38
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspecdata</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pyspecProcScripts</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">s</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="n">init_logging</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;debug&#39;</span><span class="p">)</span>

<span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;image.aspect&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span>  <span class="c1"># needed for sphinx gallery</span>
<span class="c1"># sphinx_gallery_thumbnail_number = 1</span>
<span class="n">t2</span><span class="p">,</span> <span class="n">td</span><span class="p">,</span> <span class="n">vd</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span> <span class="n">ph1</span><span class="p">,</span> <span class="n">ph2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;t2 td vd power ph1 ph2&quot;</span><span class="p">)</span>
<span class="n">f_range</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">400</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;201113_TEMPOL_capillary_probe_var_tau_1&#39;</span>
<span class="n">signal_pathway</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ph1&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;ph2&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span>
<span class="k">with</span> <span class="n">figlist_var</span><span class="p">()</span> <span class="k">as</span> <span class="n">fl</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">nodename</span><span class="p">,</span><span class="n">file_location</span><span class="p">,</span><span class="n">postproc</span><span class="p">,</span><span class="n">label</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;var_tau&#39;</span><span class="p">,</span><span class="s1">&#39;ODNP_NMR_comp/test_equipment/var_tau&#39;</span><span class="p">,</span><span class="s1">&#39;spincore_var_tau_v1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;tau is 1 ms&#39;</span><span class="p">),</span>
            <span class="p">]:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">find_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">exp_type</span><span class="o">=</span><span class="n">file_location</span><span class="p">,</span><span class="n">expno</span><span class="o">=</span><span class="n">nodename</span><span class="p">,</span>
                <span class="n">postproc</span><span class="o">=</span><span class="n">postproc</span><span class="p">,</span><span class="n">lookup</span><span class="o">=</span><span class="n">lookup_table</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;tau&#39;</span><span class="p">,:</span><span class="o">-</span><span class="mi">7</span><span class="p">]</span>
        <span class="n">tau_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">getaxis</span><span class="p">(</span><span class="s1">&#39;tau&#39;</span><span class="p">))</span>
        <span class="n">data</span><span class="o">.</span><span class="n">reorder</span><span class="p">([</span><span class="s1">&#39;ph1&#39;</span><span class="p">,</span><span class="s1">&#39;ph2&#39;</span><span class="p">,</span><span class="s1">&#39;tau&#39;</span><span class="p">,</span><span class="s1">&#39;t2&#39;</span><span class="p">])</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;t2&#39;</span><span class="p">:</span><span class="n">f_range</span><span class="p">]</span>
        <span class="n">mytable</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">mytable</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;programmed tau / ms&#39;</span><span class="p">,</span><span class="s1">&#39;estimated tau / ms&#39;</span><span class="p">,</span><span class="s1">&#39;difference / ms&#39;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tau_list</span><span class="p">)):</span>
            <span class="n">tablerow</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">alias_slop</span><span class="o">=</span><span class="mi">3</span>
            <span class="n">programmed_tau</span> <span class="o">=</span> <span class="n">tau_list</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">tablerow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">programmed_tau</span><span class="o">/</span><span class="mf">1e-3</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">strm</span><span class="p">(</span><span class="s2">&quot;programmed tau:&quot;</span><span class="p">,</span><span class="n">programmed_tau</span><span class="p">))</span>
            <span class="n">this_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;tau&#39;</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
            <span class="n">this_data</span><span class="o">.</span><span class="n">ift</span><span class="p">(</span><span class="s2">&quot;t2&quot;</span><span class="p">)</span>
            <span class="n">fl</span><span class="o">.</span><span class="n">basename</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%0.1f</span><span class="s1"> ms&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">programmed_tau</span><span class="o">/</span><span class="mf">1e-3</span><span class="p">)</span>
            <span class="n">best_shift</span> <span class="o">=</span> <span class="n">hermitian_function_test</span><span class="p">(</span>
                <span class="n">select_pathway</span><span class="p">(</span><span class="n">this_data</span><span class="p">,</span> <span class="n">signal_pathway</span><span class="p">),</span>
                <span class="n">aliasing_slop</span><span class="o">=</span><span class="n">alias_slop</span><span class="p">,</span>
                <span class="n">fl</span><span class="o">=</span><span class="n">fl</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">strm</span><span class="p">(</span><span class="s2">&quot;best shift is:&quot;</span><span class="p">,</span><span class="n">best_shift</span><span class="p">))</span>
            <span class="n">tablerow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">best_shift</span><span class="o">/</span><span class="mf">1e-3</span><span class="p">)</span>
            <span class="n">diff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">best_shift</span> <span class="o">-</span> <span class="n">programmed_tau</span><span class="p">)</span>
            <span class="n">tablerow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff</span><span class="o">/</span><span class="mf">1e-3</span><span class="p">)</span>
            <span class="n">mytable</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tablerow</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">tabulate</span><span class="p">(</span><span class="n">mytable</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mytable</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">strlens</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">mytable</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">strlens</span><span class="p">))</span>
            <span class="n">formatstr</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;%</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="si">}</span><span class="s1">.2f&#39;</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">strlens</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">mytable</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">formatstr</span><span class="o">%</span><span class="nb">tuple</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
        <span class="n">tabulate</span><span class="p">(</span><span class="n">mytable</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  23.991 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-hermitian-phasing-actual-var-tau-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/3742651215a063b1552a9ab150129b70/Hermitian_Phasing_Actual_var_tau.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">Hermitian_Phasing_Actual_var_tau.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/f217f2a693baa373323c084706ead92e/Hermitian_Phasing_Actual_var_tau.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">Hermitian_Phasing_Actual_var_tau.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="integrate_limits_realData.html" class="btn btn-neutral float-left" title="Demonstrate Integrate Limits on Experimental Data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="integrate_limits.html" class="btn btn-neutral float-right" title="Demonstrate Integrate Limits" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, John M. Franck group.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>